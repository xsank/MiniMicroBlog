var FF=window.FF||{};FF.namespace=function(){var a=arguments,o=null,i,j,d;for(i=0;i<a.length;++i){d=a[i].split(".");o=FF;for(j=(d[0]=="FF")?1:0;j<d.length;++j){o[d[j]]=o[d[j]]||{};o=o[d[j]];}}return o;};if(!Array.indexOf){Array.prototype.indexOf=function(_6){for(var i=0;i<this.length;i++){if(this[i]==_6){return i;}}return -1;};}FF.namespace("util","app","widget");(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _b=YAHOO.util.KeyListener;var _c=YAHOO.env.ua.ie;var _d=(_c==6);var _e=YAHOO.env.ua.gecko;var _f=YAHOO.env.ua.webkit;var _10=YAHOO.env.ua.opera;var _11=YAHOO.lang.isString;function trim(str){str=str.replace(/^\s\s*/,"");var ws=/\s/,i=str.length;while(ws.test(str.charAt(--i))){}return str.slice(0,i+1);}FF.CONST={TEXT_LIMIT:{message:140,privatemessage:140,help:140,pro_bas_detail:200,pro_int_misc:200,pro_int_music:200,pro_int_movie:200,pro_int_books:200,pro_int_sports:200,pro_int_persons:200},DOMAIN:"fanfou.com"};FF.util={fadeOutEl:function(){var el=jQuery(".sysmsg");var er=jQuery(".errmsg");function fadeOut(){FF.util.Effect.yellowFadeOut(el,["#ffffff","#fffcaa"]);FF.util.Effect.yellowFadeOut(er,["#ffffff","#fffcaa"]);}setTimeout(fadeOut,4000);},unique:function(arr){var _18={},_19=[];for(var i=0,l=arr.length;i<l;i++){if(!_18.hasOwnProperty(arr[i])){_18[arr[i]]=true;_19.push(arr[i]);}}return _19;},breakWord:function(el){el=$D.get(el);if(!el||el.nodeType!==1){return false;}if(el.currentStyle&&typeof el.currentStyle.wordBreak==="string"){el.runtimeStyle.wordBreak="break-all";return true;}else{if(document.createTreeWalker){var _1d=document.createTreeWalker(el,NodeFilter.SHOW_TEXT,null,false);var _1e,s,c=String.fromCharCode("8203");while(_1d.nextNode()){_1e=_1d.currentNode;s=trim(_1e.nodeValue).split("").join(c);_1e.nodeValue=s;}return true;}else{return false;}}},fixTextareaCursorPosition:function(_21){if(_11(_21)){_21=$D.get(_21);}if(_c||_10){var rng=_21.createTextRange();rng.text=_21.value;rng.collapse(false);}else{if(_f){_21.select();window.getSelection().collapseToEnd();}}},focusTextarea:function(_23){try{_23.focus();this.fixTextareaCursorPosition(_23);}catch(e){}},checkCapsLock:function(e){e=(e)?e:window.event;var _25=false;if(e.which){_25=e.which;}else{if(e.keyCode){_25=e.keyCode;}}var _26=false;if(e.shiftKey){_26=e.shiftKey;}else{if(e.modifiers){_26=!!(e.modifiers&4);}}if(_25>=97&&_25<=122&&_26){return true;}if(_25>=65&&_25<=90&&!_26){return true;}return false;},getEvalRes:function(o,_28){try{return eval("("+o.responseText+")");}catch(ex){return {"status":0,"msg":_28||"\u7f51\u7edc\u6709\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"};}},ctrlEnter:function(el,_2a){var _2b=new YAHOO.util.KeyListener(el,{ctrl:true,keys:[13,100]},function(){_2a();_2b.disable();window.setTimeout(function(){_2b.enable();},2000);});_2b.enable();},yFadeRemove:function(_2c,_2d){var p=$D.getAncestorByTagName(_2c,_2d);if(!p){return;}FF.util.Effect.yellowFadeOut(p,function(el){el.parentNode.removeChild(el);if(_c){FF.util.reFlow();}});},reFlow:function(){if(_c){document.body.style.zoom=1.1;document.body.style.zoom="";}},getLength:function(str){if(!str){return 0;}for(var i=0,_32=0,len=str.length;i<len;i++){_32=str.charCodeAt(i)>255?_32+2:_32+1;}return _32;},toFull:function(str){var ret="";for(var i=0,len=str.length;i<len;i++){var _38=str.charCodeAt(i);if(_38==32){ret+=String.fromCharCode(12288);}else{if(_38<127){ret+=String.fromCharCode(_38+65248);}else{ret+=str[i];}}}return ret;},toHalf:function(str){var ret="";for(var i=0,len=str.length;i<len;i++){var _3d=str.charCodeAt(i);if(_3d==12288){ret+=String.fromCharCode(32);}else{if(_3d>65280&&_3d<65375){ret+=String.fromCharCode(_3d-65248);}else{ret+=String.fromCharCode(_3d);}}}return ret;},toPostData:function(o){var arr=[];for(var i in o){arr.push(i+"="+o[i]);}return arr.join("&");},loadImage:function(src){var img=new Image();img.src=src;},pad:function(num,_44,_45){if(!_45){_45="0";}var len=num.toString().length;while(len<_44){num=_45+num;len++;}return num;},parseDate:function(_47){var tmp=_47.split(" ");var _49=tmp[1]+" "+tmp[2]+", "+tmp[5]+" "+tmp[3];return Date.parse(_49)-(new Date()).getTimezoneOffset()*60*1000;},getRelativeTime:function(_4a){var _4b=_11(_4a)?this.parseDate(_4a).valueOf():_4a;var now=new Date();var _4d=parseInt((now.getTime()-_4b)/1000,10);if(_4d<1){return "1 \u79d2\u524d";}else{if(_4d<60){return _4d+" \u79d2\u524d";}else{if(_4d<60*60){return parseInt(_4d/60,10)+" \u5206\u949f\u524d";}else{if(_4d<60*60*24){return "\u7ea6 "+parseInt(_4d/3600,10)+" \u5c0f\u65f6\u524d";}else{return this.getFullTime(_4a);}}}}},getFullTime:function(_4e){var d=new Date(_11(_4e)?this.parseDate(_4e):_4e);var _50=d.getFullYear();var _51=this.pad(d.getMonth()+1,2);var _52=this.pad(d.getDate(),2);var _53=this.pad(d.getHours(),2);var _54=this.pad(d.getMinutes(),2);return _50+"-"+_51+"-"+_52+" "+_53+":"+_54;},getText:function(el){if(_11(el)){el=$D.get(el);}var _56=el.innerText||el.textContent;return trim(_56);},Effect:{_yfade:function(el,_58,_59,_5a){var a=arguments,f="#fff478",t="#ffffff";if(YAHOO.lang.isArray(a[2])){f=a[2][0]?a[2][0]:f;t=a[2][1]?a[2][1]:t;}else{if(YAHOO.lang.isFunction(a[2])){var cb=a[2];}}if(YAHOO.lang.isFunction(a[3])){var cb=a[3];}var opa=_58=="out"?{from:1,to:0}:{from:0,to:1};var _60=new YAHOO.util.ColorAnim(el,{backgroundColor:{from:f,to:t},opacity:opa},1,YAHOO.util.Easing.easeNone);if("undefined"!=typeof cb){_60.onComplete.subscribe(function(){cb(el);});}_60.animate();return _60;},yellowFadeOut:function(el,_62,_63){return FF.util.Effect._yfade(el,"out",_62,_63);},yellowFadeIn:function(el,_65,_66){return FF.util.Effect._yfade(el,"in",_65,_66);}}};FF.widget={selectAndCopy:function(_67,_68,_69){if(_11(_67)){_67=$D.get(_67);}var _6a="flashcopier",_6b="flashembed";function copy(_6c){if(!$D.get(_6a)){var _6d=document.createElement("div");_6d.id=_6a;document.body.appendChild(_6d);}var _6e=$D.get(_6a);_6e.innerHTML="<embed src=\"http://static.fanfou.com/swf/cp.swf\" FlashVars=\"clipboard="+encodeURIComponent(_6c.value)+"\" width=\"0\" height=\"0\" type=\"application/x-shockwave-flash\" id=\""+_6b+"\"></embed>";var _6f=window[_6b]||document[_6b]||{};if(!_6f.SetVariable){try{return window.clipboardData.setData("Text",_6c.value);}catch(exx){return false;}}return true;}$E.on(_67,"click",doCopy);$E.on(_68,"click",doCopy);function doCopy(){if(copy(_67)&&_c){alert(_69||"\u590d\u5236\u6210\u529f\uff0c\u4f60\u53ef\u4ee5\u7c98\u5e16\u5230MSN\u6216QQ\u4e2d\u53d1\u7ed9\u597d\u53cb\u3002");}setTimeout(function(){_67.select();},0);}},fieldLimit:function(_70){if(_11(_70)){_70=$D.get(_70);}var _71=FF.CONST.TEXT_LIMIT[_70.getAttribute("id")];var _72=$D.getElementsByClassName("tip","p",_70)[0];var _73=_70.content;var _74="";if(!_71){_71=140;}window.setInterval(compute,50);$E.onDOMReady(compute);function compute(){if(!!_73){if($D.hasClass(_73,"hint")){return;}else{if(_73.value==_74){return;}else{_74=_73.value;}}var _75=$D.getElementsByClassName("formbutton","input",_70)[0];var _76=_73.value.length;if(_76===0){}else{}_72.innerHTML="<span class=\"counter\">"+(_71-_76)+"</span>";if(_76<=_71){$D.removeClass(_72,"caution");}else{$D.addClass(_72,"caution");}}}},textLimit:function(el){var _78=FF.CONST.TEXT_LIMIT[el.id];$E.on(el,"keyup",function(e){if(el.value.length>_78){el.value=el.value.slice(0,_78);$D.getElementsByClassName("hint","span",$D.getAncestorBy(el),function(o){$D.removeClass(o,"hidden");});}});}};var ie6=$.browser.msie&&$.browser.version<8;if(ie6){FF.app.QuickReply=function(_7c){var _7d=$D.get("message");var _7e=_7d["content"];var _7f=_7d["in_reply_to_status_id"];var _80=_7d["repost_status_id"];var _81=$D.get("stream");if(_7c){FF.util.focusTextarea(_7e);}$E.on(_81,"click",function(e){var _83=$E.getTarget(e);var _84=_83.nodeName.toLowerCase();if(_84=="a"&&$D.hasClass(_83,"reply")){$E.stopEvent(e);var _85=_83.getAttribute("ffname");var id=_83.getAttribute("ffid");_7e.value=combine("@"+_85,trim(_7e.value));_7f.value=id;if(_80){_80.value="";}window.scrollTo(0,0);window.setTimeout(function(){FF.util.focusTextarea(_7e);},10);}});function combine(_87,_88){var _89=" ";var _8a=_88.split(_89);if(_88.length===0){return _87+_89;}for(var i=0,len=_8a.length;i<len;i++){if(_8a[i]==_87){_8a.splice(i,1);break;}}_8a.unshift(_87);return _8a.join(_89)+_89;}};}else{FF.app.QuickReply=function(_8d){jQuery.noConflict();var _8e=jQuery("#PopupBox");var _8f=jQuery("#PopupClose",_8e);var _90=jQuery(">.act",_8e);var _91=jQuery("#PopupForm input[name~=\"ajax\"]");var _92=jQuery("#PopupForm input[name~=\"action\"]");var _93=jQuery("#PopupForm input[name~=\"in_reply_to_status_id\"]");var _94=jQuery("#PopupForm input[name~=\"repost_status_id\"]");var _95=jQuery("#PopupForm input[name~=\"token\"]");var _96=jQuery("#PopupForm textarea[name~=\"content\"]");var _97=(jQuery("#stream ol").length>0)?jQuery(">li",".message ol"):jQuery(".msg");var _98=jQuery(".op>a.reply",_97);var _99=jQuery(".op>a.repost",_97);var _9a=_8e.outerWidth();var _9b=_8e.outerHeight();var _9c=0;_8f.click(function(){_8e.fadeOut(300);_96.val("");});jQuery("body").keydown(function(_9d){if(_9d.keyCode==27){jQuery("#PopupBox").fadeOut(200);}});jQuery("#PopupForm textarea").keydown(function(_9e){if(_9e.ctrlKey&&_9e.keyCode==13){jQuery("#PopupForm").submit();}});jQuery("#PopupForm").submit(function(_9f){_9f.preventDefault();jQuery(".formbutton",this).attr("disabled","disabled");if(_96.val()===""&&document.getElementById("upload-file").value===""){alert("\u6d88\u606f\u4e0d\u80fd\u4e3a\u7a7a");jQuery(".formbutton",this).removeAttr("disabled");return false;}if(_9c){return false;}else{_9c=1;}jQuery("#PopupForm>.actpost>.loading").css({"visibility":"visible"});jQuery.post("/home",{token:_95.val(),ajax:"yes",action:"msg.post",content:_96.val(),repost_status_id:_94.val(),in_reply_to_status_id:_93.val()},function(_a0){var _a1=jQuery.parseJSON(_a0).status;var _a2=jQuery.parseJSON(_a0).msg;var e;if(_a1===0){e=jQuery("<div class=\"errmsg\">"+_a2+"</div>");}else{e=jQuery("<div class=\"sysmsg\">"+_a2+"</div>");}if(jQuery(".sysmsg, .errmsg").length>0){jQuery(".sysmsg, .errmsg").remove();}jQuery("#PopupForm>.actpost>.loading").css({"visibility":"hidden"});jQuery("#PopupForm .formbutton").removeAttr("disabled");jQuery("#header").append(e);jQuery(".sysmsg, .errmsg").delay(3500).fadeOut(500);_8e.fadeOut(300,function(){jQuery("#PopupForm .formbutton").removeAttr("disabled");_96.val("");_9c=0;});}).error(function(){jQuery("#PopupForm .formbutton").removeAttr("disabled");alert("\u6d88\u606f\u53d1\u9001\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5");});});_98.live("click",function(_a4){_a4.preventDefault();jQuery("#PopupForm textarea").attr("tabindex","3");jQuery("#PopupForm .formbutton").attr("tabindex","4");var _a5=(jQuery("#stream ol").length>0)?jQuery(this).parents("li"):jQuery(this).parents(".msg");var _a6=jQuery(".content",_a5).text();var _a7=(jQuery(">a.author",_a5).length>0)?jQuery(">a.author",_a5).text():jQuery("img.msgat").attr("alt");var _a8=jQuery(this).attr("ffid");var _a9=jQuery(window).width();var _aa=jQuery(window).height();var _ab=jQuery(document).scrollTop();var _ac=jQuery(">span.content>a.former",_a5);var _ad=new Array();if(_a6.length>20){_a6=_a6.substr(0,20)+"...";}_a6="\u56de\u590d: "+_a6;jQuery("#PopupSrc").text(_a6);_ad.push(_a7);_ac.each(function(){var _ae=jQuery(this).text();if(_ad.indexOf(_ae)<0&&_ae!==jQuery("#user_top>h3").text()){_ad.push(_ae);}});_92="msg.post";_93.val(_a8);_94.val("");_8e.css({"display":"block","left":((_a9-_9a)/2),"top":(_ab+_aa/2-_9b/2)});var _af="@"+_ad.toString().replace(/,/g," @")+" ";_96.val(_af).focus();var _b0=_96[0];if(_b0){if(_b0.createTextRange){var _b1=_b0.createTextRange();_b1.moveEnd("character",_ad.length+1);_b1.moveStart("character",_a7.length+2);_b1.select();}else{_b0.setSelectionRange(_a7.length+2,_af.length);_b0.focus();}}});};}FF.app.loadFeed=function(){$C.asyncRequest("GET","/notifications",{success:function(o){var res=YAHOO.lang.trim(o.responseText);if(res!==""){$D.get("newsfeed-list").innerHTML=res;}},failure:function(o){}});};FF.app.Stream={attach:function(el){$E.on(el,"mouseover",function(e){$D.replaceClass(this,"unlight","light");showReply(this);});$E.on(el,"mouseout",function(e){$D.replaceClass(this,"light","unlight");showReply(this);});function showReply(el){var _b9=$D.getElementsByClassName("reply","span",el);if(!_b9.length){return;}var _ba=_b9[0];var ela=_ba.getElementsByTagName("a")[0];var _bc=ela.innerHTML;var reg=/(\(查看\))$/g;if(reg.test(_bc)){ela.innerHTML=_bc.replace(reg,"");}else{ela.innerHTML=_bc+"(\u67e5\u770b)";}}},clean:function(el){el.onmouseover=null;el.onmouseout=null;},init:function(){$D.getElementsBy(function(){return true;},"li","stream",this.attach);},remove:function(el,_c0,_c1){el.blur();if(_c1&&!confirm(_c1)){return;}_c0["ajax"]="yes";var _c2=el.getAttribute("redirect");var _c3=FF.util.toPostData(_c0);var _c4=$C.asyncRequest("POST",window.location.href,{success:function(o){var res=FF.util.getEvalRes(o);if(res.status){if(_c2){window.location.href=_c2;}else{FF.util.yFadeRemove(el,"li");if(/^\/home/.test(window.location.pathname)){var _c7=el.getAttribute("href"),m=_c7.match(/^\/msg.del\/(\w+)/);if(m&&m.length&&m.length>1){var id=m[1],_ca=$D.get("lastmsg-"+id);if(_ca){_ca.innerHTML="";}}}}}else{alert(res.msg);}},failure:function(o){}},_c3);}};FF.app.Post=(function(){return {isSubmited:false,helper:function(_cc,_cd,_ce){$E.on(_cc,"keyup",function(e){ctrlEnter(e);});$E.on(_cd,"submit",function(e){submit(e);});function isKeyTrigger(e,_d2){var _d3=isKeyTrigger.arguments;var _d4=isKeyTrigger.arguments.length;var _d5=false;if(_d4>2){_d5=_d3[2];}var _d6=false;if(_d4>3){_d6=_d3[3];}var _d7=window.Event?true:false;if(typeof e=="undefined"){e=event;}if(_d5&&!((typeof e.ctrlKey!="undefined")?e.ctrlKey:e.modifiers&Event.CONTROL_MASK>0)){return false;}if(_d6&&!((typeof e.altKey!="undefined")?e.altKey:e.modifiers&Event.ALT_MASK>0)){return false;}var _d8=0;if(_d7){_d8=e.which;}else{if(e.type=="keypress"||e.type=="keydown"){_d8=e.keyCode;}else{_d8=e.button;}}return (_d8==_d2);}function ctrlEnter(e){if(_c){if(window.event.ctrlKey&&window.event.keyCode==13){submit();}}else{if(isKeyTrigger(e,13,true)){submit();}}}function submit(e){if(e){$E.stopEvent(e);}if(_cc.value===""&&document.getElementById("upload-file").value===""){alert("\u6d88\u606f\u4e0d\u80fd\u4e3a\u7a7a");return;}if(FF.app.Post.isSubmited){return;}FF.app.Post.isSubmited=true;$D.getElementsByClassName("loading","img",_cd,function(el){el.style.visibility="visible";});$D.getElementsByClassName("formbutton","input",_cd,function(el){el.disabled=true;});var _dd=_cd.getAttribute("track");if(_dd){FF.ga.trackClick(_dd);window.setTimeout(function(){_ce(_cd);},50);}else{_ce(_cd);}}},init:function(_de,_df){FF.app.Post.helper(_de,_df,function(el){el.submit();});},quickPost:function(_e1){if(_11(_e1)){_e1=$D.get(_e1);}var _e2=_e1.getElementsByTagName("textarea")[0];var _e3=$D.getElementsByClassName("loading","img",_e1)[0];var _e4=_e1["ajax"];if(!_e4){var _e5=document.createElement("input");_e5.name="ajax";_e5.value="yes";_e5.type="hidden";_e1.appendChild(_e5);}FF.app.Post.helper(_e2,_e1,function(el){$C.setForm(el);var _e7=$C.asyncRequest("POST","/home",{success:function(o){var res=FF.util.getEvalRes(o);_e3.style.visibility="hidden";$D.getElementsByClassName("formbutton","input",el,function(_ea){_ea.disabled=false;});FF.app.Post.isSubmited=false;if(res.status){var _eb=$D.get("container"),_ec=$D.get("columns"),div=$D.get("sysmsg-success");if(!div){div=document.createElement("DIV");div.id="sysmsg-success";div.className="sysmsg";div.innerHTML=" \u53d1\u9001\u6210\u529f\uff01 ";_eb.insertBefore(div,_ec);}FF.util.Effect.yellowFadeIn(div,["#ffffff","#fffcaa"]);FF.util.fadeOutEl();_e2.value="";}else{alert(res.msg);}},failure:function(o){_e3.style.visibility="hidden";$D.getElementsByClassName("formbutton","input",el,function(_ef){_ef.disabled=false;});FF.app.Post.isSubmited=false;}});if($C.isCallInProgress(_e7)){_e3.style.visibility="visible";}});}};})();FF.app.LeaveMsg=function(el){if(_11(el)){el=$D.get(el);}var _f1=$D.get("overlay");var _f2=$D.get("closeicon");var _f3=$D.get("message");var _f4=_f3["content"];var _f5=_f4.value;var _f6=$D.getElementsByClassName("formbutton","input",_f3)[0];var _f7=$D.getElementsByClassName("loading","img",_f3)[0];var _f8=false;var _f9={};$E.on(el,"click",function(e){var _fb=$D.getXY(el),x,y;$E.stopEvent(e);_f1.style.display="block";x=_fb[0]-40;y=_fb[1]+25;$D.setXY(_f1,[x,y]);FF.util.focusTextarea(_f4);});$E.on(_f2,"click",function(e){_f1.style.display="none";});$E.on(document,"click",function(e){var _100=$E.getTarget(e),_101=_100.nodeName.toLowerCase();if(_100!=_f1&&!$D.isAncestor(_f1,_100)){_f1.style.display="none";}});$E.on(_f3,"submit",doSubmit);FF.util.ctrlEnter(_f4,doSubmit);function doSubmit(e){if(e){$E.stopEvent(e);}if(_f8){return;}var msg=_f4.value;var _104=_f3.realname.value;var _105=_104.length+2;if(msg===""||msg==_f5){return alert("\u7559\u8a00\u4e0d\u80fd\u4e3a\u7a7a");}if(msg.length<_105||msg.substr(0,_105)!="@"+_104+" "){return alert("\u7559\u8a00\u5fc5\u987b\u4ee5 @"+_104+"+\u7a7a\u683c \u5f00\u5934\uff0c\u8fd9\u6837\u4f60\u7684\u5173\u6ce8\u8005\u624d\u80fd\u6536\u5230\u4f60\u53d1\u7684\u6d88\u606f\u3002");}_f8=true;_f7.style.visibility="visible";_f6.disabled=true;FF.ga.trackClick("/leavemsg");$C.setForm(_f3);$C.asyncRequest("POST","/home",{success:handleResponse,failure:function(o){}});function handleResponse(o){var res=FF.util.getEvalRes(o);if(res.status){_f8=false;_f7.style.visibility="hidden";_f6.disabled=false;_f4.value=_f5;_f1.style.display="none";var _109=$D.get("container"),_10a=$D.get("columns"),div=$D.get("sysmsg-success");if(!div){div=document.createElement("DIV");div.id="sysmsg-success";div.className="sysmsg";div.innerHTML=" \u53d1\u9001\u6210\u529f\uff01 ";_109.insertBefore(div,_10a);}FF.util.Effect.yellowFadeIn(div,["#ffffff","#fffcaa"]);FF.util.fadeOutEl();}else{alert(res.msg);}}}};FF.app.Sidebar={toggle:function(el){if(_11(el)){el=$D.get(el);}if(!el||!el.id){return;}var elb=el.getElementsByTagName("b")[0];var _10e=el.getElementsByTagName("h2")[0];var _10f=el.getElementsByTagName("ul")[0];var _110=YAHOO.util.Cookie;var _111="sidebar_collapse_"+el.id;var _112={expires:new Date(2018,1,1),path:"/",domain:FF.CONST.DOMAIN};var _113=_110.get(_111);if(_113=="true"){$D.addClass(elb,"collapse");_10f.style.display="none";}else{_10f.style.display="block";}$E.on([_10e,elb],"click",trigger);function trigger(){if($D.hasClass(elb,"collapse")){$D.removeClass(elb,"collapse");_10f.style.display="block";_110.set(_111,false,_112);}else{$D.addClass(elb,"collapse");_10f.style.display="none";_110.set(_111,true,_112);}}},init:function(){$D.getElementsByClassName("colltab","div","sidebar",this.toggle);}};})();(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _4=YAHOO.util.KeyListener;var _5=YAHOO.env.ua.ie;var _6=(_5==6);var _7=YAHOO.env.ua.gecko;var _8=YAHOO.env.ua.webkit;var _9=YAHOO.env.ua.opera;var _a=YAHOO.lang.isString;FF.cfg={cityselector:{pro_bas_province:["pro_bas_city","city"],pro_bas_homeprovince:["pro_bas_homecity","homecity"]},formpattern:{dregister:{requiredlist:"email, realname, loginpass, verifypass",verifylist:{"verifypass":"loginpass"},relist:"email, loginpass",charlist:{"realname":12}},login:{requiredlist:"loginname, loginpass"},reset:{requiredlist:"email",relist:"email"},invite:{requiredlist:"sendto"},setloginname:{requiredlist:"newname"},setpassword:{requiredlist:"loginpass, newpass, verifypass",verifylist:{"verifypass":"newpass"},relist:"loginpass, newpass, verifypass"},setrealname:{requiredlist:"realname",charlist:{"realname":12}},setemail:{requiredlist:"email",relist:"email"},setim:{requiredlist:"msn",relist:"msn"},setmobile:{requiredlist:"mobile",relist:"mobile"}},formtip:{"s-status":{"ct":"\u8f93\u5165\u6587\u5b57\u67e5\u627e\u6d88\u606f"},"s-user":{"rn":"\u8f93\u5165\u6635\u79f0\u67e5\u627e\u7528\u6237"},sharepanel:{"u":"http://"}},re:{loginpass:/^[\x21-\x7e]{4,32}$/ig,newpass:/^[\x21-\x7e]{4,32}$/ig,verifypass:/^[\x21-\x7e]{4,32}$/ig,email:/^[\w\.\-\+]+@([\w\-]+\.)+[a-z]{2,4}$/ig,msn:/^[\w\.\-\+]+@([\w\-]+\.)+[a-z]{2,4}$/ig,mobile:/(^1(3|5|8)[0-9]{9}$)|(^0060[0-9]{9}$)/}};FF.Form=function(_b){this.form={};this.url="";};FF.Form.prototype={mkForm:function(_c,_d,_e,_f){_c=_c||"post";_d=_d||window.location.href;var el=document.createElement("form");this.form=el;el.setAttribute("method",_c);el.setAttribute("action",_d);if(_e){for(var itm in _e){el.appendChild(this.getInputByMap([itm,_e[itm],"hidden"]));}}if(!_f){YAHOO.util.Dom.setStyle(el,"display","none");}document.body.appendChild(el);},getInputByMap:function(map){var _13=map.shift(),_14=map.shift(),_15=map.shift();return this.createInputEl(_13,_14,_15);},createInputEl:function(_16,_17,_18){var el=document.createElement("input");if(_16){el.setAttribute("name",_16);}if(_17){el.setAttribute("value",_17);}el.setAttribute("type",_18||"hidden");return el;},appendInputElement:function(_1a,_1b,_1c){var el=this.createInputEl(_1a,_1b,_1c);if(this.form){this.form.appendChild(el);}},post:function(_1e,fn){if(_1e){YAHOO.util.Connect.setForm(this.form);if(this.url==""){this.url=window.location.href;}var cb={success:function(o){var res=o.responseText;var r=new FF.response(res);r.show();if(fn){fn(r);}},failure:function(o){},timeout:5000};$C.asyncRequest("post",this.url,cb);}else{this.form.submit();}}};FF.ajax_prompt=function(pos,_26){this.pos=pos;var _27=document.createElement("span");this.id=YAHOO.util.Dom.generateId(_27);YAHOO.util.Dom.addClass(_27,"ajaxprompt");document.body.appendChild(_27);YAHOO.util.Dom.setX(_27,pos[0]+5);YAHOO.util.Dom.setY(_27,pos[1]+5);var _28=document.createTextNode(_26);_27.appendChild(_28);this.container=_27;};FF.ajax_prompt.prototype={change:function(_29){this.text=_29;YAHOO.util.Dom.get(this.id).firstChild.nodeValue=this.text;},off:function(){disappear(this.id,1.5);}};FF.sysmsg=function(_2a){if(_2a){this.message=_2a;}else{this.message=this.get();}};FF.sysmsg.prototype={show:function(){var arr=YAHOO.util.Dom.getElementsByClassName("sysmsg");if(arr.length>0){function f(el){el.parentNode.removeChild(el);}YAHOO.util.Dom.batch(arr,f);}var msg=document.createElement("div");YAHOO.util.Dom.addClass(msg,"sysmsg");var _2e=document.createTextNode(this.message);msg.appendChild(_2e);var _2f=YAHOO.util.Dom.get("main");YAHOO.util.Dom.insertBefore(msg,_2f);},get:function(){var _30=document.cookie;var pos=_30.indexOf("sm=");if(pos!=-1){var _32=pos+3;var end=_30.indexOf(";",_32);if(end==-1){end=_30.length;}var _34=_30.substring(_32,end);_34=_34.replace(/-/g,"+").replace(/_/g,"/");for(var i=3-(_34.length%4);i>0;i--){_34+="=";}_34=utf8to16(BASE64_decode(unescape(_34)));document.cookie="sm=;";return _34;}else{return "";}}};FF.response=function(str){var p=0,q=0;var _39=str.slice(p,p=str.indexOf(":",p));if(_39=="success"){this.status=true;}else{if(_39=="failure"){this.status=false;}else{this.status="unknown";}}var _3a=str.slice(++p,q=str.indexOf(":",p+1));if(this.status!="unknown"){if(_3a=="tip"){this.type="tip";this.content=str.substring(q+1);}else{if(_3a=="msg"){this.type="msg";this.content=str.substring(q+1);}else{if(_3a=="pop"){this.type="pop";this.content=str.substring(q+1);this.data=unserialize(utf16to8(this.content));}else{this.type=="msg";this.content=str.substring(p+1);}}}}else{this.type="msg";this.content=str;}};FF.response.prototype={show:function(){switch(this.type){case "tip":break;case "msg":var msg=new FF.sysmsg();if(msg.message==""){msg.message=this.content;}msg.show();break;case "pop":var obj=unserialize(utf16to8(this.content));this.createTag("div","poverlay",null,"root");var win=this.createTag("div","pwindow",null,"root");var _3e=document.createElement("h4");_3e.appendChild(document.createTextNode(obj["title"]));win.appendChild(_3e);var _3f=document.createElement("div");YAHOO.util.Dom.addClass(_3f,"ff");_3f.innerHTML=obj["content"];win.appendChild(_3f);var _40=document.createElement("div");YAHOO.util.Dom.addClass(_40,"act");win.appendChild(_40);var _41={"type":"button","class":"formbutton","name":"button","value":"\u786e\u5b9a"};var _42=this.createTag("input",null,_41,_40);YAHOO.util.Event.on(_42,"click",function(){win.parentNode.removeChild(win);disappear("poverlay",0.3);window.location.href=window.location.href;});break;default:break;}},createTag:function(_43,id,_45,_46){var tag=document.createElement(_43);if(id){tag.setAttribute("id",id);}if(_45){for(var itm in _45){if(itm=="class"){YAHOO.util.Dom.addClass(tag,_45[itm]);}else{tag.setAttribute(itm,_45[itm]);}}}if(_46){if(_46=="root"){document.body.appendChild(tag);}else{_46.appendChild(tag);}}return tag;}};function post_form(el){var ev=null;if(post_form.arguments.length==2){ev=post_form.arguments[1];}if(YAHOO.util.Dom.hasClass(el,"as")){if(ev){$E.stopEvent(ev);}async(el);}else{if(el.getAttribute("id")=="login"&&el["former"]){if(ev){YAHOO.util.Event.preventDefault(ev);}var _4b=new FF.Form();_4b.form=el;_4b.url="/login";_4b.appendInputElement("ajax","yes");var _4c=el["former"].value;function fn(){post_former(_4c);}_4b.post(true,fn);}else{if(!ev){el.submit();}}}}function async(el){var _4e=new FF.Form();_4e.form=el;_4e.appendInputElement("ajax","yes");_4e.post(true,function(_4f){if(_5&&el["imtype"]&&el["imtype"].value=="msn"){if(_4f&&_4f.data){FF.app.Settings.openMsnAddDialog(_4f.data.address);}}});}function post_former(str){str=BASE64_decode(str);var _51=new FF.Form();var o=unserialize(str);_51.mkForm(o["method"],o["url"],o["data"]);if(_51.form.getAttribute("method").toLowerCase()=="get"){window.location.href=_51.form.getAttribute("action");}else{_51.post();}}function disappear(el,_54){el=YAHOO.util.Dom.get(el);var _55=new YAHOO.util.Anim(el,{opacity:{to:"0"}},_54,YAHOO.util.Easing.easeInStrong);_55.onComplete.subscribe(function(){el.parentNode.removeChild(el);});_55.animate();}function utf16to8(str){var out,i,len,c;out="";len=str.length;for(i=0;i<len;i++){c=str.charCodeAt(i);if((c>=1)&&(c<=127)){out+=str.charAt(i);}else{if(c>2047){out+=String.fromCharCode(224|((c>>12)&15));out+=String.fromCharCode(128|((c>>6)&63));out+=String.fromCharCode(128|((c>>0)&63));}else{out+=String.fromCharCode(192|((c>>6)&31));out+=String.fromCharCode(128|((c>>0)&63));}}}return out;}function utf8to16(str){var out,i,len,c;var _60,_61;out="";len=str.length;i=0;while(i<len){c=str.charCodeAt(i++);switch(c>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:out+=str.charAt(i-1);break;case 12:case 13:_60=str.charCodeAt(i++);out+=String.fromCharCode(((c&31)<<6)|(_60&63));break;case 14:_60=str.charCodeAt(i++);_61=str.charCodeAt(i++);out+=String.fromCharCode(((c&15)<<12)|((_60&63)<<6)|((_61&63)<<0));break;default:break;}}return out;}function BASE64_encode(src){var _63="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var str=new Array();var ch1,ch2,ch3;var pos=0;while(pos+3<=src.length){ch1=src.charCodeAt(pos++);ch2=src.charCodeAt(pos++);ch3=src.charCodeAt(pos++);str.push(_63.charAt(ch1>>2),_63.charAt(((ch1<<4)+(ch2>>4))&63));str.push(_63.charAt(((ch2<<2)+(ch3>>6))&63),_63.charAt(ch3&63));}if(pos<src.length){ch1=src.charCodeAt(pos++);str.push(_63.charAt(ch1>>2));if(pos<src.length){ch2=src.charCodeAt(pos);str.push(_63.charAt(((ch1<<4)+(ch2>>4))&63));str.push(_63.charAt(ch2<<2&63),"=");}else{str.push(_63.charAt(ch1<<4&63),"==");}}return str.join("");}function BASE64_decode(src){var _6a=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);var str=new Array();var ch1,ch2,ch3,ch4;var pos=0;src=src.replace(/[^A-Za-z0-9\+\/]/g,"");while(pos+4<=src.length){ch1=_6a[src.charCodeAt(pos++)];ch2=_6a[src.charCodeAt(pos++)];ch3=_6a[src.charCodeAt(pos++)];ch4=_6a[src.charCodeAt(pos++)];str.push(String.fromCharCode((ch1<<2&255)+(ch2>>4),(ch2<<4&255)+(ch3>>2),(ch3<<6&255)+ch4));}if(pos+1<src.length){ch1=_6a[src.charCodeAt(pos++)];ch2=_6a[src.charCodeAt(pos++)];if(pos<src.length){ch3=_6a[src.charCodeAt(pos)];str.push(String.fromCharCode((ch1<<2&255)+(ch2>>4),(ch2<<4&255)+(ch3>>2)));}else{str.push(String.fromCharCode((ch1<<2&255)+(ch2>>4)));}}return str.join("");}function unserialize(ss){var p=0,ht=[],hv=1;var _75=function(){p++;return null;};var _76=function(){p++;var b=(ss.charAt(p++)=="1");p++;return b;};var _78=function(){p++;var i=parseInt(ss.substring(p,p=ss.indexOf(";",p)),10);p++;return i;};var _7a=function(){p++;var d=ss.substring(p,p=ss.indexOf(";",p));switch(d){case "NAN":d=NaN;break;case "INF":d=Number.POSITIVE_INFINITY;break;case "-INF":d=Number.NEGATIVE_INFINITY;break;default:d=parseFloat(d);break;}p++;return d;};var _7c=function(){p++;var l=parseInt(ss.substring(p,p=ss.indexOf(":",p)),10);p+=2;var s=utf8to16(ss.substring(p,p+=l));p+=2;return s;};var _7f=function(){p++;var n=parseInt(ss.substring(p,p=ss.indexOf(":",p)),10);p+=2;var a=[];ht[hv++]=a;for(var i=0;i<n;i++){var k;switch(ss.charAt(p++)){case "i":k=_78();break;case "s":k=_7c();break;case "U":k=_84();break;default:return false;}a[k]=_85();}p++;return a;};var _86=function(){var k,a=[];for(var i=0;i<7;i++){p++;k=_7c();p++;a[k]=_78();}var dt=new Date(a["year"],a["month"]-1,a["day"],a["hour"],a["minute"],a["second"],a["millisecond"]);ht[hv++]=dt;return dt;};var _8b=function(){p++;var l=parseInt(ss.substring(p,p=ss.indexOf(":",p)),10);p+=2;var cn=utf8to16(ss.substring(p,p+=l));p+=2;var n=parseInt(ss.substring(p,p=ss.indexOf(":",p)),10);p+=2;if(cn=="Date"&&n==7){return _86();}if(eval(["typeof(",cn,") == \"undefined\""].join(""))){eval(["function ",cn,"(){}"].join(""));}var o=eval(["new ",cn,"()"].join(""));ht[hv++]=o;for(var i=0;i<n;i++){var k;switch(ss.charAt(p++)){case "s":k=_7c();break;case "U":k=_84();break;default:return false;}if(k.charAt(0)=="\x00"){k=k.substring(k.indexOf("\x00",1)+1,k.length);}o[k]=_85();}p++;if(typeof (o.__wakeup)=="function"){o.__wakeup();}return o;};var _92=function(){p++;var l=parseInt(ss.substring(p,p=ss.indexOf(":",p)),10);p+=2;var cn=utf8to16(ss.substring(p,p+=l));p+=2;var n=parseInt(ss.substring(p,p=ss.indexOf(":",p)),10);p+=2;if(eval(["typeof(",cn,") == \"undefined\""].join(""))){eval(["function ",cn,"(){}"].join(""));}var o=eval(["new ",cn,"()"].join(""));ht[hv++]=o;if(typeof (o.unserialize)!="function"){p+=n;}else{o.unserialize(ss.substring(p,p+=n));}p++;return o;};var _84=function(){p++;var l=parseInt(ss.substring(p,p=ss.indexOf(":",p)),10);p+=2;var sb=[];for(var i=0;i<l;i++){if((sb[i]=ss.charAt(p++))=="\\"){sb[i]=String.fromCharCode(parseInt(ss.substring(p,p+=4),16));}}p+=2;return sb.join("");};var _9a=function(){p++;var r=parseInt(ss.substring(p,p=ss.indexOf(";",p)),10);p++;return ht[r];};var _85=function(){switch(ss.charAt(p++)){case "N":return ht[hv++]=_75();case "b":return ht[hv++]=_76();case "i":return ht[hv++]=_78();case "d":return ht[hv++]=_7a();case "s":return ht[hv++]=_7c();case "U":return ht[hv++]=_84();case "r":return ht[hv++]=_9a();case "a":return _7f();case "O":return _8b();case "C":return _92();case "R":return _9a();default:return false;}};return _85();}function reflow(){if(YAHOO.env.ua.ie){document.body.style.zoom=document.body.style.zoom=="1"?"100%":"1";}}function initInfos(){var el=YAHOO.util.Dom.get("user_infos");if(!el){return;}var _9d=false,_9e=YAHOO.util.Dom.getElementsByClassName("collapse","li",el),_9f=_9e.length>0?true:false,_a0=YAHOO.util.Dom.get("bio");if(_a0){var _a1=_a0.getElementsByTagName("span")[0];var _a2=_a1.innerText||_a1.textContent;if(_a2.length>60){_9d=true;}}if(_9f||_9d){if(_9d){var _a3=_a1.innerHTML;var _a4=_a2.substring(0,50).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");_a1.innerHTML=_a4;}var _a5=document.createElement("a");_a5.appendChild(document.createTextNode("(\u66f4\u591a...)"));_a5.setAttribute("title","\u70b9\u51fb\u5c55\u5f00");_a5.setAttribute("href","javascript:void 0");if(_a0){_a5.style.marginLeft=".5em";_a0.appendChild(_a5);}else{el.appendChild(_a5);}var _a6=document.createElement("a");_a6.appendChild(document.createTextNode("(\u6536\u8d77...)"));_a6.setAttribute("title","\u70b9\u51fb\u6536\u8d77");_a6.setAttribute("href","javascript:void 0");_a6.style.display="none";el.appendChild(_a6);YAHOO.util.Event.on(_a5,"click",function(e){if(_9d){_a1.innerHTML=_a3;}YAHOO.util.Dom.addClass(el,"visible");YAHOO.util.Dom.removeClass(_9e,"collapse");this.style.display="none";_a6.style.display="inline";});YAHOO.util.Event.on(_a6,"click",function(e){if(_9d){_a1.innerHTML=_a4;}YAHOO.util.Dom.removeClass(el,"visible");YAHOO.util.Dom.addClass(_9e,"collapse");this.style.display="none";_a5.style.display="inline";});}}function initSearch(){var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var el=$D.get("search-switch");var _ac=$D.get("searchr-form");if(_ac){$E.on(_ac,"submit",function(e){$E.stopEvent(e);$D.get("searchr-submit").blur();var _ae=YAHOO.lang.trim(this.q.value);if(_ae!=""){if(!(/^\/home/).test(window.location.pathname)){window.location="/home#search?q="+encodeURIComponent(_ae);return;}$D.addClass("searchr","current");FF.app.Timeline.processHomeSearch(_ae);}});}if(!el){return;}var frm=$D.get("searchpanel");var _b0=$D.get("keyword");var _b1=el.getElementsByTagName("a");$E.on(_b1,"click",function(ev){if($D.hasClass(this,"current")){_b0.focus();$E.preventDefault(ev);}else{var _b3=this.id.substring(7);$D.removeClass(_b1,"current");$D.addClass(this,"current");_b0.name=_b3;if(YAHOO.lang.trim(_b0.value)!=""){sendRequest(ev);}else{$E.preventDefault(ev);}}});$E.on(frm,"submit",sendRequest);function sendRequest(e){if(e){$E.stopEvent(e);}if(_b0.name=="q"){var url="/q/"+encodeURIComponent(_b0.value);window.location.href=url;}else{frm.submit();}}}function initClick(){$E.on(document,"click",handle);function handle(ev){if(ev.button==0){var _b7=$E.getTarget(ev);if(_b7.tagName.toLowerCase()=="img"){_b7=$D.getAncestorBy(_b7);}if(_b7.tagName.toLowerCase()=="a"&&$D.hasClass(_b7,"post_act")){$E.stopEvent(ev);dispatch(_b7);}else{if($D.hasClass(_b7,"auto-select")){_b7.select();}else{if($D.hasClass(_b7,"sharebtn")){$E.stopEvent(ev);if(((window.location.href.indexOf("/home")!=-1)||(window.location.href.indexOf("/shares")!=-1))&&confirm("\u628a\u672c\u6309\u94ae\u6dfb\u52a0\u5230\u6d4f\u89c8\u5668\u7684\u5de5\u5177\u680f\u4e0a\uff0c\u5c31\u53ef\u4ee5\u5feb\u901f\u4e0e\u4f60\u7684\u597d\u53cb\u5206\u4eab\u7f51\u9875\u3002\r\n\u662f\u5426\u67e5\u770b\u8be6\u7ec6\u7684\u64cd\u4f5c\u6307\u5357\uff1f")){window.location.href="http://help.fanfou.com/share_button.html";}}}}}}function dispatch(el){var url=el.getAttribute("href"),arr={};var pos=url.lastIndexOf("/");var _bc=url.substring(0,pos).lastIndexOf("/");if($D.hasClass(el,"sp")){var _bd=url.substring(pos+1);arr["action"]=_bd;}else{var _be=url.substring(pos+1);var _bd=url.substring(_bc+1,pos);var _bf=_bd.split(".")[0];arr["action"]=_bd;arr[_bf]=_be;}var _c0=el.getAttribute("token"),_c1="&token="+_c0;arr["token"]=_c0;if(_bd=="favorite.add"){var _c2="action="+_bd+"&"+_bf+"="+_be+"&ajax=yes"+_c1;var _c3=el.parentNode;var _c4=new FF.ajax_prompt($D.getXY(el),"\u6b63\u5728\u52a0\u5165\u6536\u85cf...");$C.asyncRequest("post","/"+_bd,{success:function(o){var res=FF.util.getEvalRes(o);if(res.status){_c4.change(res.msg);_c4.off();var _c7=$D.getAncestorByTagName(el,"li");if(_c7){var _c8=document.createElement("span");$D.addClass(_c8,"star");_c8.setAttribute("title","\u5df2\u6536\u85cf");_c8.appendChild(document.createTextNode("\u5df2\u6536\u85cf"));_c3.appendChild(_c8);}$D.addClass(el,"faved");el.setAttribute("href",url.replace(/favorite\.add/,"favorite.del"));el.setAttribute("title","\u53d6\u6d88\u6536\u85cf");el.firstChild.nodeValue="\u53d6\u6d88\u6536\u85cf";}else{_c4.change(res.msg);_c4.off();}},failure:function(o){_c4.change("\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");_c4.off();},timeout:5000},_c2);}else{if(_bd=="favorite.del"){var _c2="action="+_bd+"&"+_bf+"="+_be+"&ajax=yes"+_c1;var _c3=el.parentNode;var _c4=new FF.ajax_prompt($D.getXY(el),"\u6b63\u5728\u53d6\u6d88\u6536\u85cf...");$C.asyncRequest("post","/"+_bd,{success:function(o){var res=FF.util.getEvalRes(o);if(res.status){_c4.change(res.msg);_c4.off();var _cc=$D.getAncestorByTagName(el,"ol");if(_cc&&$D.hasClass(_cc,"self")){FF.util.yFadeRemove(_c3,"li");}else{$D.getElementsByClassName("star","span",_c3,function(){this.parentNode.removeChild(this);});$D.removeClass(el,"faved");el.setAttribute("href",url.replace(/favorite\.del/,"favorite.add"));el.setAttribute("title","\u6dfb\u52a0\u5230\u6211\u7684\u6536\u85cf");el.firstChild.nodeValue="\u6536\u85cf";}}else{_c4.change(res.msg);_c4.off();}},failure:function(o){_c4.change("\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");_c4.off();},timeout:5000},_c2);}else{if(_bd=="photo.share"){var _c2="action="+_bd+"&"+_bf+"="+_be+"&ajax=yes"+_c1;var _c4=new FF.ajax_prompt($D.getXY(el),"\u6b63\u5728\u52a0\u5165\u6536\u85cf...");$C.asyncRequest("post","/"+_bd,{success:function(o){var res=o.responseText;if(res.substring(0,7)=="success"){var str=res.substring(8);_c4.change(str);_c4.off();}else{if(res.substring(0,7)=="failure"){var str=res.substring(8);_c4.change(str);_c4.off();}else{_c4.change("\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");_c4.off();}}},failure:function(o){_c4.change("\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");_c4.off();},timeout:5000},_c2);}else{if(_bd=="notice.addall"){var str="\u4f60\u786e\u5b9a\u8981\u5173\u6ce8\u5168\u90e8\u4eba\u5417\uff1f";doPostAction(arr,str);}else{if(_bd=="notice.hideall"){var str="\u4f60\u786e\u5b9a\u8981\u9690\u85cf\u6240\u6709\u901a\u77e5\u5417\uff1f";if(!confirm(str)){return;}var _c2="action=notice.hideall&ajax=yes"+_c1,url="/notice.hideall";var _d3=$D.get("newsfeed");_d3.parentNode.removeChild(_d3);$C.asyncRequest("post",url,{success:function(o){},failure:function(o){},timeout:5000},_c2);}else{if(_bd=="notice.ignore"){var _c2="action=notice.ignore&notice="+_be+"&ajax=yes"+_c1,url="/notice.ignore";var _d3=$D.getAncestorByTagName(el,"li");if($D.getAncestorByTagName(_d3,"ul").getElementsByTagName("li").length==1){_d3=$D.get("newsfeed");}_d3.parentNode.removeChild(_d3);reflow();$C.asyncRequest("post",url,{success:function(o){},failure:function(o){},timeout:5000},_c2);return;}else{if(_bd=="tip.hide"){var _c2="action=tip.hide&tip="+_be+"&ajax=yes"+_c1,url="/tip.hide";var _d3=$D.get("systip");_d3.parentNode.removeChild(_d3);reflow();$C.asyncRequest("post",url,{success:function(o){},failure:function(o){},timeout:5000},_c2);}else{if(_bd=="msg.del"){FF.app.Stream.remove(el,arr,"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u6761\u6d88\u606f\u5417\uff1f");}else{if(_bd=="share.del"){FF.app.Stream.remove(el,arr,"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u4e2a\u6536\u85cf\u5417\uff1f");}else{if(_bd=="photo.del"){FF.app.Stream.remove(el,arr,"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u5f20\u7167\u7247\u5417\uff1f");}else{if(_bd=="friend.add"){FF.app.Friend.add(el,arr);}else{if(_bd=="friend.remove"){FF.app.Stream.remove(el,arr,"\u4f60\u786e\u5b9a\u8981\u53d6\u6d88\u5173\u6ce8\u5417\uff1f");}else{if(_bd=="userpush.del"){FF.app.Stream.remove(el,arr);}else{if(_bd=="follower.remove"){FF.app.Stream.remove(el,arr,"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f");}else{if(_bd=="user.block"){var _da=el.getAttribute("sname");var str="\u786e\u5b9a\u628a "+_da+" \u52a0\u5165\u9ed1\u540d\u5355\u5417\uff1f\u52a0\u5165\u9ed1\u540d\u5355\u540e\u4ed6\u65e2\u4e0d\u80fd\u67e5\u770b\u4f60\u7684\u4fe1\u606f\uff0c\u4e5f\u4e0d\u80fd\u7ed9\u4f60\u53d1\u79c1\u4fe1\u3002";doPostAction(arr,str);}else{if(_bd=="privatemsg.del"){FF.app.Stream.remove(el,arr,"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u6761\u79c1\u4fe1\u5417\uff1f");}else{doPostAction(arr);}}}}}}}}}}}}}}}}}function doPostAction(_db,_dc){if(_dc&&!confirm(_dc)){return;}var act=new FF.Form();act.mkForm("post",window.location.href,_db);act.post();}}function initForm(){var _de=document.getElementsByTagName("form");if(_de.length==0){return;}var tip=false;for(var i=0;i<_de.length;i++){var fm=_de[i];var id=fm.getAttribute("id");if($D.hasClass(fm,"limit")){FF.widget.fieldLimit(fm);}if(FF.cfg.formpattern[id]){chkform(fm);}if(FF.cfg.formtip[id]){var tip=true;}for(var j=0;j<fm.elements.length;j++){var _e4=fm.elements[j];if(FF.CONST.TEXT_LIMIT[_e4.getAttribute("id")]){FF.widget.textLimit(_e4);}if(tip&&FF.cfg.formtip[id][_e4.name]){var _e5=FF.cfg.formtip[id][_e4.name];setFieldTip(_e4,fm,_e5);}if(_e4.type=="submit"&&_e4.name=="remove"){YAHOO.util.Event.on(_e4,"click",function(ev){if(!confirm("\u4f60\u786e\u5b9a\u8981"+this.value+"\u5417\uff1f")){YAHOO.util.Event.preventDefault(ev);}});}if($D.hasClass(_e4,"qs")){FF.app.Post.init(_e4,fm);}}}function setFieldTip(_e7,_e8,_e9){function __add(el,str){if(el.value==""){el.value=str;YAHOO.util.Dom.addClass(el,"empty");}}function __rm(el,str){if(el.value==str){el.value="";}YAHOO.util.Dom.removeClass(el,"empty");}YAHOO.util.Event.on(_e7,"focus",function(){__rm(_e7,_e9);});YAHOO.util.Event.on(_e7,"blur",function(){__rm(_e7,_e9);__add(_e7,_e9);});YAHOO.util.Event.on(_e8,"submit",function(){__rm(_e7,_e9);});__add(_e7,_e9);}var _ee=YAHOO.util.Dom.getElementsByClassName("format-email","input","container");if(_ee.length>0){function Levenshtein_Distance(s,t){var n=s.length;var m=t.length;var d=[];var i;var j;var s_i;var t_j;var _f8;if(n==0){return m;}if(m==0){return n;}for(i=0;i<=n;i++){d[i]=[];d[i][0]=i;}for(j=0;j<=m;j++){d[0][j]=j;}for(i=1;i<=n;i++){s_i=s.charAt(i-1);for(j=1;j<=m;j++){t_j=t.charAt(j-1);if(s_i==t_j){_f8=0;}else{_f8=1;}d[i][j]=Minimum(d[i-1][j]+1,d[i][j-1]+1,d[i-1][j-1]+_f8);}}return d[n][m];}function Levenshtein_Distance_Percent(s,t){var l=s.length>t.length?s.length:t.length;var d=Levenshtein_Distance(s,t);return (1-d/l).toFixed(4);}function Minimum(a,b,c){return a<b?(a<c?a:c):(b<c?b:c);}function findSimilarest(_100){var arr=_100.split("@");var _102=0.6;var _103=["gmail.com","163.com","hotmail.com","126.com","qq.com","yahoo.com.cn","sina.com","sohu.com","msn.com","tom.com","21cn.com","live.com","yahoo.com","yeah.net","foxmail.com","vip.sina.com","eyou.com","263.net","sina.com.cn","citiz.net","live.cn","56.com","yahoo.com.tw","vip.163.com","188.com","baidu.com","xmu.edu.cn","sogou.com","mails.tsinghua.edu.cn","live.it","fudan.edu.cn","yahoo.com.hk","tencent.com","wozone.cn","vip.sohu.net","googlemail.com","gd165.com","discuz.com"];var _104=arr[1];_104=_104.toLowerCase();var max=0;var _106=-1;for(i in _103){var dist=Levenshtein_Distance_Percent(_104,_103[i]);if(dist>max){max=dist;_106=i;}}if(max>_102){arr[1]=_103[_106];var ret=arr.join("@");return ret;}else{return null;}}function checkEmail(){var _109=YAHOO.lang.trim(this.value);if(_109==0||_109.split("@").length!=2){return;}var _10a=findSimilarest(_109);if(_10a==_109||_10a==null){if(document.getElementById("email-suggest")){var tip=document.getElementById("email-tip");tip.parentNode.removeChild(tip);var _10c=document.getElementById("icon-question");_10c.parentNode.removeChild(_10c);YAHOO.util.Dom.removeClass(this,"input-question");}}else{YAHOO.util.Dom.addClass(this,"input-question");if(document.getElementById("email-suggest")){var _10d=document.getElementById("email-suggest");_10d.lastChild.nodeValue=_10a;}else{var _10e=YAHOO.util.Dom.getAncestorBy(this);YAHOO.util.Dom.setStyle(_10e,"position","relative");var tip=document.createElement("p");tip.setAttribute("id","email-tip");YAHOO.util.Dom.addClass(tip,"input-tip");_10e.appendChild(tip);tip.appendChild(document.createTextNode("\u4f60\u662f\u5426\u60f3\u8f93\u5165"));var _10f=YAHOO.util.Dom.getRegion(this);var _110=_10f["right"]-_10f["left"]-23;var _111=_10f["bottom"]-_10f["top"];YAHOO.util.Dom.setX(tip,_10f["left"]);YAHOO.util.Dom.setY(tip,_10f["bottom"]-1);YAHOO.util.Dom.setStyle(tip,"width",_110+"px");var _10d=document.createElement("strong");_10d.setAttribute("id","email-suggest");_10d.setAttribute("title","\u6211\u8981\u4f7f\u7528\u6b64email");_10d.appendChild(document.createTextNode(_10a));tip.appendChild(_10d);YAHOO.util.Dom.setStyle(_10d,"cursor","pointer");var _112=document.createElement("a");YAHOO.util.Dom.addClass(_112,"close");_112.setAttribute("href","#");_112.setAttribute("title","\u5173\u95ed");_112.appendChild(document.createTextNode("\u5173\u95ed"));tip.appendChild(_112);var _10c=document.createElement("a");_10c.setAttribute("id","icon-question");_10c.setAttribute("href","#");_10c.setAttribute("title","\u4f60\u8f93\u5165\u7684email\u53ef\u80fd\u5b58\u5728\u95ee\u9898...");_10c.appendChild(document.createTextNode("\u4f60\u8f93\u5165\u7684email\u53ef\u80fd\u5b58\u5728\u95ee\u9898..."));_10e.appendChild(_10c);YAHOO.util.Dom.setStyle(_10c,"position","absolute");YAHOO.util.Dom.setStyle(_10c,"overflow","hidden");YAHOO.util.Dom.setStyle(_10c,"display","block");YAHOO.util.Dom.setStyle(_10c,"width","18px");YAHOO.util.Dom.setStyle(_10c,"height","18px");YAHOO.util.Dom.setStyle(_10c,"text-indent","-999em");YAHOO.util.Dom.setX(_10c,_10f["right"]-21);YAHOO.util.Dom.setY(_10c,_10f["top"]+3);YAHOO.util.Event.on(_10d,"click",function(ev){YAHOO.util.Event.preventDefault(ev);this.value=_10a;_10e.removeChild(tip);_10e.removeChild(_10c);YAHOO.util.Dom.removeClass(this,"input-question");},this,true);YAHOO.util.Event.on(_112,"click",function(ev){YAHOO.util.Event.preventDefault(ev);YAHOO.util.Dom.setStyle(tip,"display","none");});YAHOO.util.Event.on(_10c,"click",function(ev){YAHOO.util.Event.preventDefault(ev);YAHOO.util.Dom.setStyle(tip,"display","block");});}}}YAHOO.util.Dom.batch(_ee,function(el){YAHOO.util.Event.on(el,"blur",checkEmail);});}}function chkform(fm){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _11b=false;var id=fm.getAttribute("id");var _11d=FF.cfg.formpattern[id].relist;var _11e=FF.cfg.formpattern[id].verifylist;var _11f=FF.cfg.formpattern[id].requiredlist;var _120=FF.cfg.formpattern[id].charlist;function markError(_121){$D.addClass($D.getAncestorBy(_121),"error");}function fixError(_122){$D.removeClass($D.getAncestorBy(_122),"error");}function chkRE(s,r){r.lastIndex=0;if(s.length&&!r.test(s)){return false;}else{return true;}}function verify(s,s2){if(((!_11b&&s.length)||(_11b||s.length))&&s!=s2){return false;}else{return true;}}function chkRequired(s,b){if(s.length==0){return false;}else{if(b){return true;}else{return "i";}}}function chkLength(s,n){var num=0;for(var i=0;i<s.length;i++){if(s.charCodeAt(i)<128){num++;}else{num+=2;}}if(num>n){return false;}else{return true;}}function chkPattern(){for(var i=0;i<fm.elements.length;i++){var f=fm[i];var name=f.getAttribute("name");if(name==""){continue;}var str=YAHOO.lang.trim(f.value);var _131=true;if(_11d&&_11d.indexOf(name)!=-1){if(name=="mobile"){str=str.replace(/[\s-]+/g,"");}!chkRE(str,FF.cfg.re[name])?markError(f):fixError(f);_131=false;}if(_11e&&_11e[name]){!verify(f.value,fm[_11e[name]].value)?markError(f):fixError(f);_131=false;}if(_120&&_120[name]){!chkLength(str,_120[name])?markError(f):fixError(f);_131=false;}if(_11f&&_11b&&(_11f.indexOf(name)!=-1)){var sw=chkRequired(f.value,_131);if(sw=="i"){}else{!sw?markError(f):fixError(f);}}}}$D.batch(fm.elements,function(el){$E.on(el,"focus",function(){$D.addClass($D.getAncestorBy(this),"inputting");});$E.on(el,"blur",function(){$D.removeClass($D.getAncestorBy(this),"inputting");chkPattern();});});$E.on(fm,"submit",function(ev){_11b=true;chkPattern();var _135=$D.getElementsByClassName("error","p",fm);if(_135.length>0){alert("\u4fe1\u606f\u586b\u5199\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5");$E.preventDefault(ev);return;}post_form(fm,ev);});}FF.ga={init:function(){var s=document.createElement("script");s.type="text/javascript";s.src="http://www.google-analytics.com/ga.js";document.getElementsByTagName("head")[0].appendChild(s);var _137,_138=0,_139=window.setInterval(function(){if(_138>599){window.clearInterval(_139);}if(!_137){try{_137=_gat._getTracker("UA-1805418-1");_137._addOrganic("baidu","word");_137._addOrganic("soso","w");_137._addOrganic("3721","name");_137._addOrganic("yodao","q");_137._addOrganic("vnet","kw");_137._addOrganic("sogou","query");_137._addOrganic("gougou","search");FF.gat=_137;if(FF.gaCallback){FF.gaCallback(_137);}}catch(ex){}}else{window.clearInterval(_139);FF.ga.setRules(_137);}++_138;},200);},setRules:function(_13a){var l=window.location.href,h=window.location.host,host=h.match(/^(?:www\.)?(\w+\.com)/);host=(host&&host.length>1)?host[1]:"fanfou.com";_13a._setDomainName(host);if(FF.gaCode){var code="/"+FF.gaCode;}else{var code=l.replace(new RegExp("^http://"+host+"/"),"");}_13a._trackPageview(code);},trackClick:function(code){if(!FF.gat){return;}FF.gat._trackPageview(code);}};YAHOO.util.Event.onDOMReady(function(){initClick();FF.app.Stream.init();FF.ga.init();});YAHOO.util.Event.onContentReady("container",initInfos);YAHOO.util.Event.onContentReady("container",initSearch);YAHOO.util.Event.onContentReady("container",initForm);if($(".sysmsg",".errmsg")){FF.util.fadeOutEl();}})();(function(){var $D=YAHOO.util.Dom,$E=YAHOO.util.Event,_3=YAHOO.util.CustomEvent;FF.namespace("widget.Tab");FF.widget.Tab=function(_4,_5,_6){this.tabs=[];this.currentTab=null;this.config={defaultIndex:0,triggerEvent:"click",slideEnabled:false,slideInterval:3000,slideDelay:300,autoInit:true,onShow:function(){}};this.setConfig(_6);this.onShow=new _3("onShow",this);this.onShow.subscribe(this.config["onShow"]);if(_4&&_5){this.addRange(_4,_5);if(this.config.autoInit){this.init();}}};FF.widget.Tab.prototype={setConfig:function(_7){if(!_7){return;}for(var i in _7){this.config[i]=_7[i];}},add:function(_9,_a){_9=$D.get(_9);_a=$D.get(_a);if(_9&&_a){this.tabs.push({"trigger":_9,"sheet":_a});}},addRange:function(_b,_c){if(!_b||!_c){return;}if(_b.length&&_c.length&&_b.length==_c.length){for(var i=0,_e=_b.length;i<_e;i++){this.add(_b[i],_c[i]);}}},select:function(_f){if(!_f||_f==this.currentTab){return;}if(this.currentTab){$D.removeClass(this.currentTab.trigger,"current");this.currentTab.sheet.style.display="none";}this.currentTab=_f;this.show();},show:function(){$D.addClass(this.currentTab.trigger,"current");this.currentTab.sheet.style.display="block";this.onShow.fire(this.currentTab);},slide:function(){var _10=this.config,_11=this,_12,_13;$D.batch(this.tabs,function(tab){$E.on([tab.trigger,tab.sheet],"mouseover",clear);$E.on([tab.trigger,tab.sheet],"mouseout",delay);});start();function start(){var i=_11.indexOf(_11.currentTab);if(i==-1){return;}_12=window.setInterval(function(){var tab=_11.tabs[++i%_11.tabs.length];if(tab){_11.select(tab);}},_10["slideInterval"]);}function clear(){window.clearTimeout(_13);window.clearInterval(_12);}function delay(){_13=window.setTimeout(start,_10["slideDelay"]);}},indexOf:function(tab){for(var i=0,len=this.tabs.length;i<len;i++){if(tab==this.tabs[i]){return i;}}return -1;},init:function(){var _1a=this.config,_1b=this;$D.batch(this.tabs,function(tab){$E.on(tab.trigger,_1a["triggerEvent"],function(e){_1b.select.call(_1b,tab);$E.stopEvent(e);});tab.sheet.style.display="none";});this.select(this.tabs[_1a["defaultIndex"]]);if(_1a["slideEnabled"]){this.slide();}}};})();(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _4=YAHOO.util.KeyListener;var _5=YAHOO.env.ua.ie;var _6=(_5==6);var _7=YAHOO.env.ua.gecko;var _8=YAHOO.env.ua.webkit;var _9=YAHOO.env.ua.opera;var _a=YAHOO.lang.isString;FF.app.Apps={revoke:function(){$D.getElementsByClassName("authorize","a","apps-list",function(el){$E.on(el,"click",function(e){$E.stopEvent(e);var _d=this.getAttribute("token");var _e=this.getAttribute("access_token");var _f={ajax:"yes",action:"settings.revoke",token:_d,access_token:_e};$C.asyncRequest("POST","/settings/revoke",{success:function(o){handleResponse(el,o);},failure:function(o){}},FF.util.toPostData(_f));});});function handleResponse(el,o){var res=FF.util.getEvalRes(o);if(res.status){var _15=$D.getAncestorByTagName(el,"td");if($D.hasClass(el,"revoke")){if(!_6){$D.setStyle(_15,"opacity",0.5);}$D.removeClass(el,"revoke");el.innerHTML="\u91cd\u65b0\u901a\u8fc7";}else{if(!_6){$D.setStyle(_15,"opacity",1);}$D.addClass(el,"revoke");el.innerHTML="\u53d6\u6d88\u8ba4\u8bc1";}}else{alert(res.msg);}}},reset:function(){$E.on("resetkey","click",function(e){this.blur();var _17=this.getAttribute("token");var id=this.getAttribute("sid");var _19={ajax:"yes",action:"apps.resetkey",token:_17,id:id};$C.asyncRequest("POST","/apps.resetkey",{success:handleResponse,failure:function(o){}},FF.util.toPostData(_19));});function handleResponse(o){var res=FF.util.getEvalRes(o);var _1d=$D.get("app-consumer-key");var _1e=$D.get("app-consumer-secret");if(res.status){_1d.innerHTML=res.data["key"];_1e.innerHTML=res.data["secret"];FF.util.Effect.yellowFadeIn(_1d,["#fffcaa","#ffffff"]);FF.util.Effect.yellowFadeIn(_1e,["#fffcaa","#ffffff"]);}else{alert(res.msg);}}}};})();(function(){var $D=YAHOO.util.Dom,$E=YAHOO.util.Event,_3="",_4={width:180,height:400},_5="",_6="",_7;function genFlashCode(_8){var _9=$D.get("flashbadge");_5=_9?_9.className:"";var _a=$D.get("preview").getElementsByTagName("embed")[0];if(!_7){_7=_a.src;}if(typeof _8=="undefined"){_8=true;}var _b=_7;_b+="&title="+encodeURIComponent(_6)+"&width="+_4.width+"&height="+_4.height+"&maincolor="+_3+"&titlecolor=ffffff&textcolor=333333&texthover=eeeeee&timecolor=999999&use_bgcolor=no&bgcolor=ffffff";var _c="<embed height=\""+_4.height+"\" width=\""+_4.width+"\" wmode=\"transparent\" quality=\"autohigh\" src=\""+_b+"\" pluginspage=\"http://www.adobe.com/go/getflashplayer\" type=\"application/x-shockwave-flash\"></embed>";if(_8){if(YAHOO.env.ua.gecko){_a.src=_b;_a.width=_4.width;_a.height=_4.height;}else{$D.get("preview").innerHTML=_c;}}if(_5!="qq"){$D.get("flash_badge_code").value=_c;}else{$D.get("flash_badge_code").value=_b;}}function configFlashBadge(){var _d=$D.get("fb-colors"),_e=_d.getElementsByTagName("li")[0].getElementsByTagName("div")[0];_3=_e.getAttribute("color").replace(/^#/,"");_6=$D.get("fb-title").value;$D.addClass(_e,"fb-checked");$E.on(_d,"click",function(e){$E.stopEvent(e);var t=$E.getTarget(e),nn=t.nodeName.toLowerCase();if(nn!="li"){t=$D.getAncestorByTagName(t,"li");}nn=t.nodeName.toLowerCase();if(nn!="li"){return;}var _12=t.getElementsByTagName("div")[0];if(_e==_12){return;}$D.removeClass(_e,"fb-checked");_e=_12;$D.addClass(_e,"fb-checked");_3=_e.getAttribute("color").replace(/^#/,"");genFlashCode();});$E.on("fb-title","blur",function(e){_6=this.value;genFlashCode();});var ws=$D.get("fb-wsize-small"),wn=$D.get("fb-wsize-normal"),wc=$D.get("fb-wsize-custom");$E.on([ws,ws.parentNode],"click",function(e){if(ws.checked){_4={width:180,height:400};}genFlashCode();});$E.on([wn,wn.parentNode],"click",function(e){if(wn.checked){_4={width:180,height:600};}genFlashCode();});var w=$D.get("fb-width"),h=$D.get("fb-height");$E.on([w,h],"focus",function(e){wc.checked=true;});$E.on([wc,wc.parentNode],"click",function(e){if(wc.checked){_4={width:w.value,height:h.value};}genFlashCode();});$E.on([w,h],"blur",function(e){var wv=parseInt(w.value,10),hv=parseInt(h.value,10);if(wv>300){w.value=300;}if(wv<150||isNaN(wv)){w.value=150;}if(hv>600){h.value=600;}if(hv<200||isNaN(hv)){h.value=200;}_4={width:w.value,height:h.value};genFlashCode();});genFlashCode();}function configImageBadge(){var _20=$D.get("type-m");var _21=$D.get("type-s");var _22=$D.get("count");var _23=$D.get("type");var _24=$D.get("width");var _25=$D.get("multi-xhtml");var _26=$D.get("multi-ubb");var _27=$D.get("imageurl");var _28=$D.get("user").value;$E.on(_22,"change",genImageCode);$E.on(_20,"click",function(e){_23.value="m";genImageCode();});$E.on(_21,"click",function(e){_23.value="s";genImageCode();});$E.on(_24,"click",genImageCode);$E.on(_24,"keyup",genImageCode);$E.on(_24,"blur",genImageCode);genImageCode();function genImageCode(){var _2b="<a href=\"http://fanfou.com/{user}\" target=\"_blank\" title=\"\u996d\u5426\"><img src=\"http://b.fanfou.com/u/{user}/{type}{width}{count}.png\" alt=\"\u996d\u5426\" /></a>";var _2c="http://b.fanfou.com/u/{user}/{type}{width}{count}.png";var _2d="[url=http://fanfou.com/{user}][img]http://b.fanfou.com/u/{user}/{type}{width}{count}.png[/img][/url]";var _2e=(function(){var _2f=parseInt(_24.value,10);if(isNaN(_2f)||_2f==200||_2f<160||_2f>240){return "";}else{return _2f;}})();var _30=_23.value;var _31=_22.options[_22.selectedIndex].value;if(_30=="s"){_24.disabled=true;_22.disabled=true;}else{_24.disabled=false;_22.disabled=false;}_2b=_2b.replace(/{user}/g,_28).replace(/{type}/g,_30);_2c=_2c.replace(/{user}/g,_28).replace(/{type}/g,_30);_2d=_2d.replace(/{user}/g,_28).replace(/{type}/g,_30);if(_30=="m"){_2b=_2b.replace(/{width}/g,_2e).replace(/{count}/g,"_"+_31);_2c=_2c.replace(/{width}/g,_2e).replace(/{count}/g,"_"+_31);_2d=_2d.replace(/{width}/g,_2e).replace(/{count}/g,"_"+_31);}else{_2b=_2b.replace(/{\w+}/g,"");_2c=_2c.replace(/{\w+}/g,"");}if(_25){_25.value=_2b;}if(_26){_26.value=_2d;}if(_27){_27.value=_2c;}$D.get("previewImg").src=_2c;}}function copyCode(){if(YAHOO.env.ua.ie){var _32=$D.getElementsByClassName("block","div","badges");var _33=YAHOO.util.Dom.getElementsByClassName("code","textarea","badges",function(el){var _35=$D.getAncestorByTagName(el,"div");var _36=document.createElement("p");var _37=document.createElement("input");$D.addClass(_36,"act");_37.type="button";_37.value="\u590d\u5236\u4ee3\u7801";$D.addClass(_37,"formbutton");_36.appendChild(_37);YAHOO.util.Event.addListener(_37,"click",function(){copyToClipboard(el);});_35.appendChild(_36);});function copyToClipboard(el){el.select();window.clipboardData.clearData();if(window.clipboardData.setData("text",el.value)){alert("\u590d\u5236\u6210\u529f\uff01");}}}}FF.app.Badge={init:function(){copyCode();if($D.get("setflash")){configFlashBadge();}if($D.get("setimage")){configImageBadge();}var els=$D.getElementsByClassName("help-tip","a","badges",function(el){var id=el.getAttribute("hid");var _3c=$D.get(id);$E.on(el,"click",function(e){if(_3c){_3c.style.display="";}else{$E.stopEvent(e);}});});var _3e=window.location.hash;if(_3e&&_3e.indexOf("help-tip")!=-1){var el=$D.get("help-tip");if(!el){return;}var id=el.getAttribute("hid");var _41=$D.get(id);_41.style.display="";window.scrollTo(0,$D.getY(el));}}};})();(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _4=YAHOO.env.ua.ie;var _5=(_4==6);var _6=false;FF.namespace("app.Finder");FF.app.Finder={_createLoading:function(){var _7=new YAHOO.widget.Panel("finder_wait",{width:"240px",fixedcenter:true,close:false,draggable:false,zindex:7,modal:true,visible:false});_7.setHeader("\u6b63\u5728\u67e5\u627e\uff0c\u8bf7\u7a0d\u5019...");_7.setBody("<p><img src=\"http://static.fanfou.com/img/loading_progress.gif\" width=\"220\" height=\"19\" alt=\"...\" /></p><p>\u6b64\u8fc7\u7a0b\u53ef\u80fd\u9700\u8981\u51e0\u5206\u949f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85...</p>");_7.render(document.body);return _7;},setMask:function(_8){if(!_8){return;}var _9=$D.getXY(_8);_8.style.height=$D.getDocumentHeight()+"px";if(!_6){_8.style.width=$D.getDocumentWidth()+"px";_8.style.left="-"+_9[0]+"px";_8.style.top="-"+_9[1]+"px";_6=true;}if(_4){var _a=$D.get("footer");$D.setStyle(_a,"position","relative");$D.setStyle(_a,"opacity","0.45");$D.getElementsByClassName("ui-roundedbox-tl","div",_a,function(el){});}},initQQVCode:function(){var _c=$D.get("finder_qq_vcode"),_d=$D.get("finder_qq_password"),_e=$D.get("finder_qq_vcode_img"),_f=$D.get("finder_qq_key"),_10=$D.get("finder_wait_mask"),_11=$D.get("finder_qq_vcode_w"),_12=false,_13=this;$E.on(_d,"focus",function(e){if(_12){return;}_11.style.display="block";loadkey();_13.setMask(_10);});$E.on("finder_qq_vcode_refresh","click",function(e){$E.stopEvent(e);loadkey();});function update(key,el){el.src="/qq.vfcode?key="+key;_f.value=key;window.setTimeout(function(){_13.setMask(_10);},100);}function loadkey(){var _18=$D.get("qq_importkey");var _19=$D.get("qq_qqnum");var url;if(_18&&_19){url="/qq.preparesec?key="+_18.value+"&qqnum="+_19.value;}else{url="/qq.prepare";}var _1b=$C.asyncRequest("GET",url,{success:function(o){var res;try{res=eval("("+o.responseText+")");}catch(e){res={};}if(res.status==1&&res.msg){_12=true;update(res.msg,_e);}else{_e.src="";_e.alt="\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u5237\u65b0";}},failure:function(o){_e.src="";_e.alt="\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u5237\u65b0";}});if($C.isCallInProgress(_1b)){_e.src="http://static.fanfou.com/img/ajax-loader.gif";}}},initTab:function(_1f){var _20=document.getElementById("finder_cate_main").getElementsByTagName("form");var _21=$D.get("finder_wait_mask");var img=new Image(220,19),_23=new Image(40,2150);img.src="http://static.fanfou.com/img/loading_progress.gif";_23.src="http://static.fanfou.com/js/yui/2.7.0/assets/skins/sam/sprite.png";var _24;var _25=this;var _26=window.location.hash,_27=0;if(_1f){switch(_1f){case "msn":_27=1;break;case "gtalk":_27=2;break;case "email":_27=3;break;case "qq":default:_27=0;break;}}if(_26.indexOf("finder_qq")!=-1||_26.indexOf("guide_qq")!=-1){_27=0;}else{if(_26.indexOf("finder_msn")!=-1||_26.indexOf("guide_msn")!=-1){_27=1;}else{if(_26.indexOf("finder_gtalk")!=-1||_26.indexOf("guide_gtalk")!=-1){_27=2;}else{if(_26.indexOf("finder_email")!=-1||_26.indexOf("guide_email")!=-1){_27=3;}}}}if(_26.replace(/#/,"")!==""){window.setTimeout(function(){window.scrollTo(0,0);},200);}initTabbar();initTabContact();if(_21){_25.setMask(_21);}$D.batch(_20,function(frm){$E.on(frm,"submit",function(e){dosubmit(frm,e);});});function initTabbar(){var _2a=new FF.widget.Tab(["trigger_finder","trigger_invite"],["finder_finder","finder_invite"]);_2a.onShow.subscribe(function(t,a){var _2d=a[0].trigger,_2e=document.getElementById("finder_cate_side_title");var txt=_2d.innerText||_2d.textContent;_2d.blur();if(txt=="\u627e\u4eba"){_2e.innerHTML="\u5bfb\u627e\u5176\u4ed6\u8054\u7cfb\u4eba";$D.batch(_20,function(frm){frm.setAttribute("action",frm.getAttribute("action").replace(/finder\.invite/,"finder"));frm["act"].value=frm.getAttribute("action").replace(/\//,"");});}else{_2e.innerHTML="\u9080\u8bf7\u5176\u4ed6\u8054\u7cfb\u4eba";$D.batch(_20,function(frm){frm.setAttribute("action",frm.getAttribute("action").replace(/finder/,"finder.invite"));frm["act"].value=frm.getAttribute("action").replace(/\//,"");});}});if(_26.indexOf("finder_invite")!=-1){_2a.select(_2a.tabs[1]);}}function initTabContact(){var _32=new FF.widget.Tab(document.getElementById("finder_cate_side_list").getElementsByTagName("a"),["finder_msn","finder_gtalk","finder_email"],{defaultIndex:_27,autoInit:false});_32.onShow.subscribe(function(t,a){var el=a[0].trigger;el.blur();var _36=$D.get("guide-next");var _37=el.getAttribute("fid");var frm=$D.get(_37);if(frm){if(_37=="finder_form_qq"&&!_21){frm.login.focus();FF.util.fixTextareaCursorPosition(frm.login);}else{if(!frm.login.value){frm.login.focus();}else{if(!frm.password.value){window.setTimeout(function(){frm.password.focus();},800);}}}}if(_36&&_37){_36.setAttribute("fid",_37);}});_32.init();}function dosubmit(frm,e){$E.stopEvent(e);if(!frm["login"].value||!frm["password"].value){var _3b=frm.action;if(_3b.indexOf("guide")!=-1){alert("\u8bf7\u586b\u5199\u5b8c\u6574\u7684\u5e10\u53f7\u6216\u5bc6\u7801\uff1b \u5982\u679c\u60f3\u8df3\u8fc7\u6b64\u6b65\uff0c\u8bf7\u70b9\u51fb\u8df3\u8fc7");}return;}else{if(frm["vfcode"]&&!frm["vfcode"].value){alert("\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801");frm["vfcode"].focus();return;}}var _3c=this["domain"];if(_3c&&_3c.options[_3c.selectedIndex].value===""){_3c.focus();_3c.parentNode.style.borderColor="#cc0000";_3c.parentNode.style.borderWidth="1px";_3c.parentNode.style.borderStyle="solid";$E.stopEvent(e);return;}_24=_24||_25._createLoading();_24.show();frm.submit();}$E.on("guide-next","click",function(e){var _3e=this.getAttribute("fid");dosubmit($D.get(_3e),e);});$E.on("finder_invite_preview_link","click",function(e){$E.stopEvent(e);var _40=$D.get("finder_invite_preview");_40.style.display=_40.style.display!="block"?"block":"none";this.innerHTML=_40.style.display!="block"?"\u9884\u89c8":"\u6536\u8d77";FF.util.reFlow();});},handleTable:function(_41,_42,_43){_41=$D.get(_41);_42=$D.get(_42);var trs=_41.getElementsByTagName("tr");var _45=$D.getElementsBy(function(el){return el.type=="checkbox";},"input",_41);for(var i=0,n=trs.length;i<n;i++){if(i&1){$D.addClass(trs[i],"alt");}}$E.on(_41,"click",function(e){var t=$E.getTarget(e),nn=t.nodeName.toLowerCase(),p;if(nn=="input"){return;}if(nn!="tr"){p=$D.getAncestorByTagName(t,"tr");}else{p=t;}var _4d=p.getElementsByTagName("input")[0];_4d.checked=!_4d.checked;if(_43){handleSideAvatar(_4d);}});var _4e=YAHOO.env.ua.ie?"propertychange":"change";$E.on(_42,_4e,function(e){var _50=false;if(_42.checked){_50=true;}$D.batch(_45,function(_51){_51.checked=_50;if(_43){handleSideAvatar(_51);}});});if(_43){var _52=_41.getElementsByTagName("img"),_53=$D.get("finder_willfollow_list");$D.batch(_52,function(img){var _55=img.cloneNode(true);_55.id=_55.id.replace(/finder_avatar_/,"finder_avatar_side_");_53.appendChild(_55);});$E.on(_45,_4e,function(e){handleSideAvatar(this);});function handleSideAvatar(_57){var dis;if(_57.checked){dis="block";}else{dis="none";}$D.get("finder_avatar_side_"+_57.value).style.display=dis;}}},postContacts:function(_59){_59=$D.get(_59);var _5a=this._createLoading();_5a.show();_59.submit();}};})();FF.namespace("app.Form");FF.app.Form=(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _4=YAHOO.util.KeyListener;var _5=YAHOO.env.ua.ie;var _6=(_5==6);var _7=YAHOO.env.ua.gecko;var _8=YAHOO.env.ua.webkit;var _9=YAHOO.env.ua.opera;var _a=YAHOO.lang.isString;var _b={loginname:/^[\.\w\u4e00-\u9fa5\uF900-\uFA2D]{4,32}$/ig,realname:/^[\.\w\u4e00-\u9fa5\uF900-\uFA2D]{2,12}$/ig,loginpass:/^[\x21-\x7e]{4,32}$/ig,newpass:/^[\x21-\x7e]{4,32}$/ig,verifypass:/^[\x21-\x7e]{4,32}$/ig,email:/^[\w\.\-\+]+@([\w\-]+\.)+[a-z]{2,4}$/ig,msn:/^[\w\.\-\+]+@([\w\-]+\.)+[a-z]{2,4}$/ig,mobile:/^1(3|5|8)[0-9]{9}$/};var _c=["gmail.com","163.com","hotmail.com","126.com","qq.com","yahoo.com.cn","sina.com","sohu.com","msn.com","tom.com","21cn.com","live.com","yahoo.com","yeah.net","foxmail.com","vip.sina.com","eyou.com","263.net","sina.com.cn","citiz.net","live.cn","56.com","yahoo.com.tw","vip.163.com","188.com","baidu.com","xmu.edu.cn","sogou.com","mails.tsinghua.edu.cn","live.it","fudan.edu.cn","yahoo.com.hk","tencent.com","wozone.cn","vip.sohu.net","googlemail.com","gd165.com","discuz.com"];function checkReg(_d,_e){if(!_d){return false;}_e.lastIndex=0;return _e.test(_d);}function setHint(el,_10,_11){_10=_10?_10:"";_11=_11?_11:"&nbsp;";el.className=_10;el.innerHTML=_11;}function getHint(el){return $D.getNextSibling(el);}return {checkEmail:function(_13){function Levenshtein_Distance(s,t){var n=s.length;var m=t.length;var d=[];var i;var j;var s_i;var t_j;var _1d;if(n==0){return m;}if(m==0){return n;}for(i=0;i<=n;i++){d[i]=[];d[i][0]=i;}for(j=0;j<=m;j++){d[0][j]=j;}for(i=1;i<=n;i++){s_i=s.charAt(i-1);for(j=1;j<=m;j++){t_j=t.charAt(j-1);if(s_i==t_j){_1d=0;}else{_1d=1;}d[i][j]=Minimum(d[i-1][j]+1,d[i][j-1]+1,d[i-1][j-1]+_1d);}}return d[n][m];}function Levenshtein_Distance_Percent(s,t){var l=s.length>t.length?s.length:t.length;var d=Levenshtein_Distance(s,t);return (1-d/l).toFixed(4);}function Minimum(a,b,c){return a<b?(a<c?a:c):(b<c?b:c);}function findSimilarest(_25){var arr=_25.split("@");var _27=0.7;var _28=arr[1];_28=_28.toLowerCase();var max=0;var _2a=-1;for(i in _c){var _2b=Levenshtein_Distance_Percent(_28,_c[i]);if(_2b>max){max=_2b;_2a=i;}}if(max>_27){arr[1]=_c[_2a];var ret=arr.join("@");return ret;}else{return null;}}var _2d=YAHOO.lang.trim(_13.value);if(_2d==0||_2d.split("@").length!=2){return;}var _2e=findSimilarest(_2d);var _2f=$D.get("email-suggest");var _30=$D.get("icon-question");var _31=$D.get("email-tip");var _32=$D.get("email-hint");if(_2e==_2d||_2e==null){_31.style.display="none";_30.style.display="none";$D.removeClass(_13,"input-question");}else{_31.style.display="block";_30.style.display="block";$D.addClass(_13,"input-question");_2f.lastChild.nodeValue=_2e;$E.on(_2f,"click",function(ev){$E.preventDefault(ev);this.value=_2e;$D.removeClass(this,"input-question");_31.style.display="none";_30.style.display="none";setHint(_32,"");},_13,true);$E.on(_30,"click",function(e){$E.stopEvent(e);$D.setStyle(_31,"display","block");});$E.on("email-close","click",function(e){$E.stopEvent(e);$D.setStyle(_31,"display","none");});}},autoComplete:function(_36){var _37=_36.value;var _38=_37.split("@");var _39=$D.get("email-auto");_39.style.display="none";if(_38.length!=2||_38[1]==""){return;}var _3a=find(_38[1]);var len=_3a.length;var _3c=[];for(var i=0;i<len;i++){var _3e=_38[0]+"@"+_3a[i];if(len==1&&_3e==_37){}else{_3c.push("<li "+(i==0?"class=\"current\"":"")+" s=\""+_3e+"\">");_3c.push(_3e);_3c.push("</li>");}}if(_3c.length){_39.style.display="block";_39.innerHTML="<ul id=\"email-auto-list\">"+_3c.join("")+"</ul>";var els=$D.get("email-auto-list").getElementsByTagName("li");$D.batch(els,function(el){$E.on(el,"mouseover",function(){$D.addClass(el,"current");});$E.on(el,"mouseout",function(){$D.removeClass(el,"current");});});}function find(str){var ret=[];for(var i=0,len=_c.length;i<len;i++){var reg=new RegExp("^"+str,"g");if(reg.test(_c[i])){ret.push(_c[i]);}}return ret;}},register:function(_45){if(_a(_45)){_45=$D.get(_45);}var _46=_45.loginname;var _47=_45.realname;var _48=_45.loginpass;var _49=_45.verifypass;var _4a=_45.email;var _4b=$D.get("email-auto");var _4c=$D.get("url-loginname");var _4d=$D.get("loginname-hint");var _4e=$D.get("realname-hint");var _4f=$D.get("loginpass-hint");var _50=$D.get("verifypass-hint");var _51=$D.get("email-hint");var _52=[];var _53,_54,_55,_56;var _57=_9?"input":"keyup";var _58=this;function clear(_59){if(_52[_59]){window.clearInterval(_52[_59]);}}$D.batch([_46,_47,_48,_49,_4a],function(el){$E.on(el,"focus",function(e){$D.removeClass($D.getAncestorBy(el),"error");});});$E.on(_45,"submit",function(e){var _5d=false;$E.stopEvent(e);for(var i=0,len=_45.elements.length;i<len;i++){if(_45.elements[i].value==""){_5d=true;}}if(_5d){alert("\u4fe1\u606f\u586b\u5199\u4e0d\u5b8c\u6574\uff0c\u8bf7\u68c0\u67e5");return;}if($D.getElementsByClassName("wrong","span",_45).length){alert("\u4fe1\u606f\u586b\u5199\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5");}else{_45.submit();}});_52["check-realname"]=window.setInterval(function(){var _60=FF.util.toHalf(_47.value);if(_55==_60){return;}else{_55=_60;}if(FF.util.getLength(_60)<4){return;}var _61="action=register.check&realname="+_60;var _62=$C.asyncRequest("post","/register.check",{success:checkRealname,failure:function(o){}},_61);},2000);_52["check-email"]=window.setInterval(function(){var _64=_4a.value;var _65=checkReg(_64,_b["email"]);if(_4a.value==""){return;}if(!_65){setHint(_51,"wrong","Email\u683c\u5f0f\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165");return;}if(_56==_64){return;}else{_56=_64;}var _66="action=register.check&email="+_64;var _67=$C.asyncRequest("post","/register.check",{success:checkEmailAjax,failure:function(o){}},_66);},2000);function checkLoginname(o){var res=FF.util.getEvalRes(o);if(res.status==1){setHint(_4d,"right");_4c.className="available";}else{setHint(_4d,"wrong",res.msg);_4c.className="unavailable";}}function checkRealname(o){var res=FF.util.getEvalRes(o);if(res.status==1){setHint(_4e,"right");}else{setHint(_4e,"wrong",res.msg);}}function checkEmailAjax(o){var res=FF.util.getEvalRes(o);if(res.status==1){setHint(_51,"right");}else{setHint(_51,"wrong",res.msg);}}$E.on(_47,_57,function(e){var _70=_47.value;var _71=FF.util.toHalf(_70);if(_71!=_70){_47.value=_71;_70=_71;}var len=FF.util.getLength(_70);if(len<4){setHint(_4e,"");}else{setHint(_4e,"loading");}});$E.on(_47,"focus",function(e){});$E.on(_47,"blur",function(e){var _75=_47.value;var len=FF.util.getLength(_75);var _77=checkReg(_75,_b["realname"]);if(_75==""){setHint(_4e,"");}else{if(len<4){setHint(_4e,"wrong","\u6635\u79f0\u957f\u5ea6\u592a\u77ed\uff0c\u6700\u5c11 2 \u4e2a\u6c49\u5b57\u6216 4 \u4e2a\u5b57\u7b26");}else{if(_75.length>12){setHint(_4e,"wrong","\u6700\u591a 12 \u4e2a\u5b57\u7b26");}else{if(/^[\.\_-]/.test(_75)){setHint(_4e,"wrong","\u8bf7\u4ee5\u4e2d\u6587\u6216\u82f1\u6587\u5b57\u6bcd\u5f00\u5934");}}}}});$E.on(_48,"keypress",function(e){if(FF.util.checkCapsLock(e)){setHint(_4f,"warning","\u63d0\u9192\uff1a\u5927\u5199\u9501\u5b9a\u952e\u5728\u5f00\u542f\u72b6\u6001");}else{if(_48.value!=""){setHint(_4f,"");}}});$E.on(_48,"keyup",function(e){});$E.on(_49,"keypress",function(e){if(FF.util.checkCapsLock(e)){setHint(_50,"warning","\u63d0\u9192\uff1a\u5927\u5199\u9501\u5b9a\u952e\u5728\u5f00\u542f\u72b6\u6001");}else{setHint(_50,"");}});$E.on(_48,"focus",function(e){});$E.on(_49,"focus",function(e){});$E.on(_48,"blur",function(e){var _7e=this.value;if(_7e==""){setHint(_4f,"");return;}var _7f=checkReg(_7e,_b["loginpass"]);if(_7f){setHint(_4f,"right");}else{setHint(_4f,"wrong","\u5bc6\u7801\u957f\u5ea6\u592a\u77ed\uff0c\u6700\u5c11 4 \u4e2a\u5b57\u7b26");}});$E.on(_49,"blur",function(e){var _81=this.value;var _82=_48.value;if(_81==""){setHint(_50,"");return;}var _83=checkReg(_81,_b["loginpass"]);if(_81!=_82){setHint(_50,"wrong","\u5bc6\u7801\u4e0d\u4e00\u81f4\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165");}else{if(_83){setHint(_50,"right");}else{setHint(_50,"wrong","\u5bc6\u7801\u957f\u5ea6\u592a\u77ed\uff0c\u6700\u5c11 4 \u4e2a\u5b57\u7b26");}}});$E.on(_4a,"blur",function(e){if(_4a.value==""){setHint(_51,"");}window.setTimeout(function(){_4b.style.display="none";},500);clear("autoComplete");_58.checkEmail(this);});$E.on(_4a,"focus",function(e){setHint(_51,"");$D.get("email-tip").style.display="none";_52["autoComplete"]=window.setInterval(function(){if(_53==_4a.value){return;}_53=_4a.value;_58.autoComplete(_4a);},30);});$E.on(_4a,_57,function(e){var _87=_4a.value;var _88=FF.util.toHalf(_87);if(_88!=_87){_4a.value=_88;}});initEmailKey();function initEmailKey(){var _89=new _4(_4a,{keys:40},function(_8a,_8b){var els=$D.get("email-auto-list").getElementsByTagName("li");if(!els.length){return;}if($D.getStyle(_4b,"display")!="none"){var _8d=getCurrent(els);if(_8d){var _8e=$D.getNextSibling(_8d);if(_8e){$D.removeClass(_8d,"current");$D.addClass(_8e,"current");}}else{$D.addClass(els[0],"current");}}});var _8f=new _4(_4a,{keys:38},function(_90,_91){var els=$D.get("email-auto-list").getElementsByTagName("li");if(!els.length){return;}if($D.getStyle(_4b,"display")!="none"){var _93=getCurrent(els);if(_93){var _94=$D.getPreviousSibling(_93);if(_94){$D.removeClass(_93,"current");$D.addClass(_94,"current");}}}});var _95=new _4(_4a,{keys:13},function(_96,_97){var e=_97[1];$E.stopEvent(e);var els=$D.get("email-auto-list").getElementsByTagName("li");var _9a=getCurrent(els);if(_9a){_4a.value=_9a.getAttribute("s");}});_89.enable();_8f.enable();_95.enable();$E.on(document,"click",function(e){var _9c=$E.getTarget(e);var _9d=_9c.nodeName.toLowerCase();if(_9d=="li"&&_9c.getAttribute("s")){var _9e=_9c.getAttribute("s");_4a.value=_9e;}window.setTimeout(function(){_4b.style.display="none";},10);});function getCurrent(els){for(var i=0,len=els.length;i<len;i++){if($D.hasClass(els[i],"current")){return els[i];}}return null;}}},reset:function(){},login:function(){}};})();if(!Array.indexOf){Array.prototype.indexOf=function(_1){for(var i=0;i<this.length;i++){if(this[i]==_1){return i;}}return -1;};}(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _6=YAHOO.util.KeyListener;var _7=YAHOO.env.ua.ie;var _8=(_7==6);var _9=YAHOO.env.ua.gecko;var _a=YAHOO.env.ua.webkit;var _b=YAHOO.env.ua.opera;var _c=YAHOO.lang.isString;var _d=$.browser.msie&&$.browser.version<8;if(_d){FF.app.Repost=function(){var _e=$D.get("stream");var _f=$D.get("message");if(!_e){return;}$E.on(_e,"click",function(e){var _11=$E.getTarget(e);var _12=_11.nodeName.toLowerCase();if(_12=="a"&&$D.hasClass(_11,"repost")){$E.stopEvent(e);if(_f){var _13=_f["content"];var _14=_f["repost_status_id"];var _15=_f["in_reply_to_status_id"];var _16=_11.getAttribute("text");var id=_11.getAttribute("ffid");_13.value=_16;if(_13.setSelectionRange){_13.focus();_13.setSelectionRange(1,1);}else{if(_13.createTextRange){var _18=_13.createTextRange();_18.collapse(true);_18.moveEnd("character",0);_18.moveStart("character",0);_18.select();}}_14.value=id;if(_15){_15.value="";}window.scrollTo(0,0);window.setTimeout(function(){focus(_13);},10);}else{window.location.href=_11.getAttribute("href");}}});function focus(_19){_19.focus();FF.util.fixTextareaCursorPosition(_19);}};}else{FF.app.Repost=function(){var _1a=jQuery("#PopupBox");var _1b=jQuery("#PopupClose",_1a);var _1c=jQuery(">.act",_1a);var _1d=jQuery("#PopupForm input[name~=\"ajax\"]");var _1e=jQuery("#PopupForm input[name~=\"action\"]");var _1f=jQuery("#PopupForm input[name~=\"in_reply_to_status_id\"]");var _20=jQuery("#PopupForm input[name~=\"repost_status_id\"]");var _21=jQuery("#PopupForm input[name~=\"token\"]");var _22=jQuery("#PopupForm textarea[name~=\"content\"]");if(jQuery(">li","#stream ol").length>0){var _23=jQuery(">li","#stream ol");var _24=jQuery(">span.op>a.reply",_23);var _25=jQuery(">span.op>a.repost",_23);}else{if(jQuery("#photo").length>0){var _23=jQuery("#photo");var _24=jQuery(">p.op>a.reply",_23);var _25=jQuery(">p.op>a.repost",_23);}else{var _23=jQuery(".msg");var _24=jQuery(".op>a.reply",_23);var _25=jQuery(".op>a.repost",_23);}}var _26=_1a.outerWidth();var _27=_1a.outerHeight();_1b.click(function(){_1a.fadeOut(300);_22.val("");});_25.live("click",function(_28){_28.preventDefault();jQuery("#PopupForm textarea").attr("tabindex","3");jQuery("#PopupForm .formbutton").attr("tabindex","4");jQuery("#PopupSrc").text("");jQuery("#message>p>textarea.qs").val("");var _29=(jQuery("#stream ol").length>0)?jQuery(this).parents("li"):jQuery(this).parents(".msg");var _2a=(jQuery(">a.author",_29).length>0)?jQuery(">a.author",_29).text():jQuery("#avatar img").attr("alt");var _2b=jQuery(this).attr("ffid");var _2c=jQuery(window).width();var _2d=jQuery(window).height();var _2e=jQuery(document).scrollTop();var _2f=jQuery(">span.content>a.former",_29);var _30=new Array();_30.push(_2a);_2f.each(function(){var _31=jQuery(this).text();if(_30.indexOf(_31)<0&&_31!==jQuery("#user_top>h3").text()){_30.push(_31);}});_1d="yes";_1e="msg.post";jQuery("#PopupForm input[name~=\"repost_status_id\"]").val(_2b);_1f.val("");_1a.css({"display":"block","left":((_2c-_26)/2),"top":(_2e+_2d/2-_27/2)});var _32=jQuery(this)[0].getAttribute("text");_22.val(_32).focus();var _33=_22[0];if(_33.createTextRange){var _34=_33.createTextRange();_34.moveEnd("character",1);_34.moveStart("character",1);}else{_33.setSelectionRange(0,0);_33.focus();}});};}FF.app.PrivateMsg={select:function(){var _35=$D.get("privatemessage");var _36=_35["content"];var _37=$D.getElementsByClassName("loading","img",_35)[0];var _38=$D.get("nameselect");var _39=$D.get("sendto");var _3a=$D.get("names");var _3b=$D.get("name-all-link");var _3c=$D.get("name-auto");var _3d=$D.get("name-all");var _3e=_3a.value.split("$");var _3f=_b?"input":"keyup";var _40=/[^\(]+\(([^\)]+)\)/g;var _41=/\(([^\)]+)\)/g;var max=1000;var _43=50;var _44="magic_empty_string";var _45="\u8f93\u5165\u6635\u79f0\u67e5\u627e...";var _46=null,_47="",_48={},_49={};init();$E.on(_38,"focus",function(e){if(_38.value==_45){_38.value="";$D.removeClass(_38,"hint");}_46=window.setInterval(function(){var str=_38.value.toLowerCase();var _4c;if(_47==str){return;}_47=str;_4c=find(str);buildNames(_3c,_4c,str,true);$D.removeClass(_3b,"name-all-unfold");},30);});$E.on(_38,"blur",function(){clear();if(_38.value==""){_38.value=_45;$D.addClass(_38,"hint");}});$E.on(_3b,"click",function(e){_3b.blur();if($D.hasClass(_3b,"name-all-unfold")){$D.removeClass(_3b,"name-all-unfold");_3c.style.visibility="hidden";}else{$D.addClass(_3b,"name-all-unfold");clear();buildNames(_3c,find(_44),_44,true);}});$E.on(_35,"submit",doSubmit);FF.util.ctrlEnter(_36,doSubmit);function doSubmit(e){if(e){$E.stopEvent(e);}var str=_38.value;var _50=_36.value;if(_50==""){alert("\u79c1\u4fe1\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a");_36.focus();return;}else{if(!_40.exec(str)){return alert("\u6536\u4fe1\u4eba\u683c\u5f0f\u4e0d\u6b63\u786e");}else{_39.value=RegExp.$1;_40.lastIndex=0;}}_37.style.visibility="visible";_3a.value="";window.setTimeout(function(){_35.submit();},100);}function init(){if(_38.value==""){_38.value=_45;$D.addClass(_38,"hint");}initKey();var _51="abcdefghijklmnopqrstuvwxyz".split("");for(var i=0,len=_51.length;i<len;i++){var _54=find(_51[i]);buildHTML(_54,_51[i]);}var _55=buildHTML(find(_44),_44);}function find(str){if(!str){return [];}if(_48[str]){return _48[str];}var ret=[];function sort(a,b){var len=str.length;if(a.substr(0,len).toLowerCase()==str){return -1;}else{if(b.substr(0,len).toLowerCase()==str){return 1;}else{return a.localeCompare(b);}}}if(str==_44){ret=_3e;if(ret.length>max){ret=ret.slice(0,max);}}else{for(var i=0,len=_3e.length;i<len;i++){var _5d=_3e[i].toLowerCase();if(_5d.indexOf(str)!=-1){if(ret.length<max){ret[ret.length]=_3e[i];}else{break;}}}ret=ret.sort(sort);if(ret.length>_43){ret=ret.slice(0,_43);}}return _48[str]=ret;}function buildHTML(_5e,str){if(!_5e.length){return "";}if(_49[str]){return _49[str];}var arr=[];var len=_5e.length;arr.push("<ul>");for(var i=0;i<len;i++){var _63=_5e[i].replace(_41,function(a){return " <span class=\"loginname\">"+a+"</span>";});arr.push("<li "+(i==0?"class=\"current\"":"")+" sname=\""+_5e[i]+"\">");arr.push(_63);arr.push("</li>");}arr.push("</ul>");_49[str]=arr.join("");return _49[str];}function buildNames(_65,_66,_67,_68){var len=_66.length,_6a;if(!len||(len==1&&_66[0]==_38.value)){_65.style.visibility="hidden";return;}if(len<7){_65.style.height="auto";}else{_65.style.height="";}if(len>max){_66=_66.slice(0,max);len=max;}_6a=buildHTML(_66,_67);var els=_65.getElementsByTagName("li");for(var i=0,len=els.length;i<len;i++){els[i].onmouseover=null;els[i].onmouseout=null;}_65.innerHTML="";asyncInnerHTML(_6a,function(_6d){_65.appendChild(_6d);if(_68){_65.style.visibility="visible";_65.scrollTop=0;}var els=_65.getElementsByTagName("li");var _6f=els.length?els[0]:null;for(var i=0,len=els.length;i<len;i++){(function(el){el.onmouseover=function(){if(_6f){_6f.className="";}el.className="current";_6f=el;};el.onmouseout=function(){el.className="";};})(els[i]);}});}function focus(){_36.focus();FF.util.fixTextareaCursorPosition(_36);}function clear(){if(_46){window.clearInterval(_46);}}function initKey(){var _72=7;var _73=24;var _74=new _6(_38,{keys:40},function(_75,_76){var el=getContainer();var els=el.getElementsByTagName("li");if($D.getStyle(el,"visibility")!="hidden"){var _79=getCurrent(els);if(_79){var _7a=$D.getNextSibling(_79);if(_7a){$D.removeClass(_79,"current");$D.addClass(_7a,"current");window.setTimeout(function(){var _7b=getIndex(_7a,els);if(_7b>_72-1){el.scrollTop+=_73;}},50);}}else{if(els.length){$D.addClass(els[0],"current");}}}});var _7c=new _6(_38,{keys:38},function(_7d,_7e){var el=getContainer();var els=el.getElementsByTagName("li");if($D.getStyle(el,"visibility")!="hidden"){var _81=getCurrent(els);if(_81){var _82=$D.getPreviousSibling(_81);if(_82){$D.removeClass(_81,"current");$D.addClass(_82,"current");window.setTimeout(function(){var _83=getIndex(_82,els);if((_83+1)*_73>el.scrollTop){}else{el.scrollTop-=_73;}},50);}}}});var _84=new _6(_38,{keys:13},function(_85,_86){var e=_86[1];$E.stopEvent(e);var el=getContainer();var els=el.getElementsByTagName("li");var _8a=getCurrent(els);if(_8a){_38.value=_8a.getAttribute("sname");$D.removeClass(_38,"hint");}window.setTimeout(function(){el.style.visibility="hidden";focus();},10);});_74.enable();_7c.enable();_84.enable();$E.on(document,"click",function(e){var _8c=$E.getTarget(e);var _8d=_8c.nodeName.toLowerCase();if(_8d=="span"&&$D.hasClass(_8c,"loginname")){var _8e=$D.getAncestorBy(_8c);if(_8e&&_8e.getAttribute("sname")){_8d="li";_8c=_8e;}}if(_8d=="li"&&_8c.getAttribute("sname")){var _8f=_8c.getAttribute("sname");_38.value=_8f;$D.removeClass(_38,"hint");focus();}window.setTimeout(function(){if(_8c==_38||_8c==_3b){return;}else{$D.removeClass(_3b,"name-all-unfold");_3c.style.visibility="hidden";}},10);});function getContainer(){return _3c;}function getCurrent(els){for(var i=0,len=els.length;i<len;i++){if($D.hasClass(els[i],"current")){return els[i];}}return null;}function getIndex(el,els){for(var i=0,len=els.length;i<len;i++){if(el==els[i]){return i;}}return -1;}function getHeight(el){if(!el){return 0;}var _98=$D.getRegion(el);var _99=_98.bottom-_98.top;return _99>0?_99:0;}}function asyncInnerHTML(_9a,_9b){var _9c=document.createElement("div"),_9d=document.createDocumentFragment();_9c.innerHTML=_9a;(function(){if(_9c.firstChild){_9d.appendChild(_9c.firstChild);setTimeout(arguments.callee,0);}else{_9b(_9d);}})();}function removeAllChild(el){while(el.firstChild){var _9f=el.firstChild;el.removeChild(_9f);}}}};FF.app.Settings=(function(){function setHint(el,_a1,_a2){_a1=_a1?_a1:"";_a2=_a2?_a2:"&nbsp;";el.className=_a1;el.innerHTML=_a2;}function sendRequest(_a3,_a4){var arr={action:"register.check"};for(var i in _a3){arr[i]=_a3[i];}$C.asyncRequest("POST","/register.check",{success:_a4,failure:function(o){}},FF.util.toPostData(arr));}return {openMsnAddDialog:function(_a8){if(!_a8){return;}try{window.setTimeout(function(){var frm=$D.get("msn-bind-open");frm.action="msnim:add?contact="+_a8;frm.submit();},100);}catch(e){}},_noticeDialog:null,getNoticeDialog:function(){if(!this._noticeDialog){var _aa={width:"500px",fixedcenter:true,close:false,draggable:false,zindex:7,modal:true,visible:false};this._noticeDialog=new YAHOO.widget.Panel("settings-realname-notice",_aa);}return this._noticeDialog;},base:function(){var _ab=$D.get("setprofile");var _ac=$D.get("loginname-hint");var _ad=$D.get("realname-hint");var _ae=_ab.realname;var _af=_ab.loginname;var _b0=_ae.value;var _b1=_b0;var _b2=null;var _b3=_ab.token.value;var _b4=_b?"input":"keyup";var _b5="\u4e00\u65e6\u66f4\u6539\u5c06\u4e0d\u80fd\u6539\u56de \u201c"+_b0+"\u201d \uff0c\u56e0\u4e3a\u5df2\u7ecf\u6709\u5176\u4ed6\u7528\u6237\u4f7f\u7528\u8fd9\u4e2a\u6635\u79f0\u3002";var _b6=this;var _b7=false;var _b8={};_b8["realname"]=window.setInterval(function(){var _b9=FF.util.toHalf(_ae.value);if(_b1==_b9){return;}_b1=_b9;if(FF.util.getLength(_b9)<4){return;}if(_b9==_b0){setHint(_ad);}else{sendRequest({realname:_b9,token:_b3},onRealnameTyping);}},2000);if(_af){_b8["loginname"]=window.setInterval(function(){var _ba=FF.util.toHalf(_af.value);if(_b2==_ba){return;}_b2=_ba;if(FF.util.getLength(_ba)<4){return;}sendRequest({loginname:_ba,token:_b3},onLoginnameTyping);},2000);}$E.on(["acc_realname","acc_loginname"],"focus",function(e){var _bc=$D.getAncestorByTagName(this,"p");$D.removeClass($D.getElementsByClassName("hint","span",_bc),"hidden");});$E.on(_ae,_b4,function(e){var _be=_ae.value;var _bf=FF.util.toHalf(_be);if(_bf!=_be){_ae.value=_bf;_be=_bf;}if(_be==_b0){setHint(_ad);}else{if(FF.util.getLength(_be)<4){setHint(_ad);}else{setHint(_ad,"loading");}}});$E.on(_af,_b4,function(e){var _c1=_af.value;var _c2=FF.util.toHalf(_c1);if(_c2!=_c1){_af.value=_c2;_c1=_c2;}if(FF.util.getLength(_c1)<4){setHint(_ac);}else{setHint(_ac,"loading");}});$E.on(_ab,"submit",function(e){$E.stopEvent(e);if(_b7){return alert("\u7f51\u5740\u6709\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u3002");}var _c4=_ae.value;if(_c4==_b0){this.submit();}else{sendRequest({realname:_c4,token:_b3},onRealnameSubmit);}});function onRealnameTyping(o){var res=FF.util.getEvalRes(o);if(res.status==1){if(res.data&&res.data["rnrepeat"]){setHint(_ad,"right",_b5);}else{setHint(_ad,"right");}}else{setHint(_ad,"wrong",res.msg);}}function onLoginnameTyping(o){var res=FF.util.getEvalRes(o);if(res.status==1){_b7=false;setHint(_ac,"right");}else{_b7=true;setHint(_ac,"wrong");}}function onRealnameSubmit(o){var res=FF.util.getEvalRes(o);if(res.status==1){if(res.data&&res.data["rnrepeat"]){showNotice();}else{_ab.submit();}}else{setHint(_ad,"wrong",res.msg);alert(res.msg);}}function showNotice(){var _cb=_b6.getNoticeDialog();_cb.setBody("<div class=\"notice\"><h3>\u4f60\u786e\u5b9a\u8981\u5c06\u6635\u79f0\u4fee\u6539\u4e3a \u201c"+_ae.value+"\u201d \u5417\uff1f</h3><p>"+_b5+"</p></div>");_cb.setFooter("<p class=\"act\"><input type=\"button\" value=\"\u786e\u5b9a\" id=\"realname-submit\" class=\"formbutton\" /><input type=\"button\" value=\"\u53d6\u6d88\" id=\"realname-cancel\" class=\"formbutton cancel\" /></p>");_cb.render(document.body);_cb.show();$E.on("realname-submit","click",function(e){_cb.hide();_ab.submit();});$E.on("realname-cancel","click",function(e){_cb.hide();});}}};})();FF.app.Friend={add:function(el,_cf){el.blur();if($D.hasClass(el,"bl-added")){return;}var _d0=$D.getAncestorByTagName(el,"li");var _d1=FF.util.toPostData(_cf);var _d2=$C.asyncRequest("POST","/friend.add",{success:function(o){var res=FF.util.getEvalRes(o);if(res.status){el.innerHTML="\u5df2\u5173\u6ce8";FF.util.Effect.yellowFadeIn(_d0);$D.replaceClass(el,"bh","bl-added");_d0.innerHTML=_d0.innerHTML.replace(/开始关注你了|\(|\)/ig,"");$D.getElementsByClassName("friend-remove","a",_d0,function(el){el.style.display="none";});}else{alert(res.msg);}},failure:function(o){}},_d1);}};FF.app.Testing=(function(){var _d7=[];return {record:function(){_d7.push(new Date());},getTimes:function(){return _d7;},time:function(_d8){var len=_d7.length,_da;if(len<2){return 0;}_da=_d7[len].getTime()-_d7[len-1].getTime();if(_d8){_d8(_da);}return _da;}};})();})();FF.namespace("app.Search");FF.app.Search=(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _4=YAHOO.env.ua.ie;var _5=(_4==6);var _6=YAHOO.env.ua.gecko;var _7=YAHOO.env.ua.webkit;var _8=YAHOO.env.ua.opera;var _9=YAHOO.lang.isString;var _a=YAHOO.lang.trim;function checkdate(_b){var _c=/(19[0-9]{2}|20[0-9]{2})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/;return _b&&_c.test(_b);}return {check:function(){var _d=$D.get("advancedsearch");$E.on(_d,"submit",function(e){if(e){$E.stopEvent(e);}var _f=_a(_d.begin.value);var end=_a(_d.end.value);if(_f&&!checkdate(_f)){$D.addClass(_d.begin,"err");return alert("\u5f00\u59cb\u65f6\u95f4\u6709\u8bef");}else{$D.removeClass(_d.begin,"err");}if(end&&!checkdate(end)){$D.addClass(_d.end,"err");return alert("\u7ed3\u675f\u65f6\u95f4\u6709\u8bef");}else{$D.removeClass(_d.end,"err");}_d.submit();});},share:function(){elShare=$D.get("search-result-share");if(!elShare){return;}var _11=$D.get("overlay");var _12=$D.get("closeicon");var _13=$D.get("message");var _14=_13["content"];var _15=$D.getElementsByClassName("formbutton","input",_13)[0];var _16=$D.getElementsByClassName("loading","img",_13)[0];var _17=false;var _18={};$E.on(elShare,"click",function(e){var _1a=$D.getXY(elShare),x,y;$E.stopEvent(e);_11.style.display="block";x=_1a[0]-450;y=_1a[1]+25;$D.setXY(_11,[x,y]);_14.focus();FF.util.fixTextareaCursorPosition(_14);});$E.on(_12,"click",function(e){_11.style.display="none";});$E.on(document,"click",function(e){var _1f=$E.getTarget(e),_20=_1f.nodeName.toLowerCase();if(_1f!=_11&&!$D.isAncestor(_11,_1f)){_11.style.display="none";}});$E.on(_13,"submit",doSubmit);FF.util.ctrlEnter(_14,function(){doSubmit();});function doSubmit(e){if(e){$E.stopEvent(e);}if(_17){return;}var msg=_14.value;if(msg==""){return alert("\u7559\u8a00\u4e0d\u80fd\u4e3a\u7a7a");}_17=true;_16.style.visibility="visible";_15.disabled=true;FF.ga.trackClick("/searchresultshare");$C.setForm(_13);$C.asyncRequest("POST","/home",{success:handleResponse,failure:function(o){}});function handleResponse(o){var res=FF.util.getEvalRes(o);if(res.status){_17=false;_16.style.visibility="hidden";_15.disabled=false;_11.style.display="none";var _26=$D.get("container"),_27=$D.get("columns"),div=$D.get("sysmsg-success");if(!div){div=document.createElement("DIV");div.id="sysmsg-success";div.className="sysmsg";div.innerHTML=" \u641c\u7d22\u7ed3\u679c\u8f6c\u53d1\u6210\u529f\uff01 ";_26.insertBefore(div,_27);}FF.util.Effect.yellowFadeIn(div,["#ffffff","#fffcaa"]);}else{alert(res.msg);}}}},save:function(){var _29=$D.get("search-result-save");if(!_29){return;}$E.on(_29,"click",request);function request(e){$E.stopEvent(e);var _2b={ajax:"yes"};var _2c=this.getAttribute("sword");var _2d=this.getAttribute("action");var id=this.getAttribute("sid");var _2f=_2d=="create";_2b["q"]=_2c;_2b["id"]=id;_2b["action"]="savedsearch."+_2d;_2b["token"]=this.getAttribute("token");var _30=$C.asyncRequest("POST","/home",{success:function(o){handleResponse(o,_2c,_2f);},failure:function(o){}},FF.util.toPostData(_2b));}function handleResponse(o,_34,_35){var res=FF.util.getEvalRes(o);var _37=$D.get("container");var _38=$D.get("columns");var div=$D.get("sysmsg-success");if(!div){div=document.createElement("DIV");div.id="sysmsg-success";div.className="sysmsg";_37.insertBefore(div,_38);}if(res.status){if(_35){div.innerHTML=" \u4fdd\u5b58\u6210\u529f\uff01 ";setSaveLink(_34,res.id);}else{div.innerHTML=" \u5220\u9664\u6210\u529f\uff01 ";setSaveLink(_34);}FF.util.Effect.yellowFadeIn(div,["#ffffff","#fffcaa"]);}else{alert(res.msg);}}function setSaveLink(_3a,_3b){var _3c=$D.getAncestorByTagName(_29,"li");var _3d=_29.innerHTML;if(_3b){_29.setAttribute("action","destroy");_29.setAttribute("sid",_3b);_29.setAttribute("title",_3d.replace("\u4fdd\u5b58","\u5220\u9664"));_29.innerHTML=_3d.replace("\u4fdd\u5b58","\u5220\u9664");_3c.className="search-destroy";}else{_29.setAttribute("action","create");_29.setAttribute("sid",0);_29.setAttribute("title",_3d.replace("\u5220\u9664","\u4fdd\u5b58"));_29.innerHTML=_3d.replace("\u5220\u9664","\u4fdd\u5b58");_3c.className="search-create";}}}};})();FF.namespace("app.Theme");FF.app.Theme=(function(){var $C=YAHOO.util.Connect,$D=YAHOO.util.Dom,$E=YAHOO.util.Event,_4=YAHOO.env.ua.ie,_5=false,_6=[],_7,_8,_9,_a,_b,_c,_d,_e,_f,_10;return {render:function(id){var _12=_6[id];if(_12){this.setBg(_12.thumb,_12.bgpic,_12.repeat,_12.center,_12.colors["bg"],_12.colors["text"]);this.setLinks(_12.colors["links"]);this.setSidebar(_12.colors["sidebar"],_12.colors["sborder"]);this.setInputs(_12.colors);_e.themeid.value=id;_e.hidebg.value=0;}},setBg:function(_13,pic,_15,_16,_17,_18){if(pic!=undefined){$D.setStyle(document.body,"backgroundImage","url("+pic+")");}if(_13&&pic!=""){$D.setStyle(_9,"backgroundImage","url("+_13+")");_9.setAttribute("rel",pic);}if(_15!=undefined){$D.setStyle(document.body,"backgroundRepeat",_15?"repeat":"no-repeat");$D.setStyle(document.body,"backgroundAttachment",_15?"scroll":"fixed");_b.checked=_15?true:false;if(_15){_c.checked=false;$D.setStyle(document.body,"backgroundPosition","top left");}}if(_16!=undefined){$D.setStyle(document.body,"backgroundPosition",_16?"top center":"top left");_c.checked=_16?true:false;if(_16){_b.checked=false;$D.setStyle(document.body,"backgroundRepeat","no-repeat");}}if(_17){$D.setStyle(document.body,"backgroundColor",_17);}if(_18){$D.setStyle(document.body,"color",_18);}if(_4){window.setTimeout(function(){document.body.style.zoom=1.1;document.body.style.zoom="";},10);}},setLinks:function(_19){if(!_19){return;}$D.batch(document.getElementsByTagName("a"),function(el){el.style.color=_19;});},setSidebar:function(_1b,_1c){var _1d=$D.get("sidebar");if(_1b){$D.setStyle(_1d,"backgroundColor",_1b);}if(_1c){$D.setStyle(_1d,"borderColor",_1c);}},setInputs:function(_1e){var _1f=this;_e["user-color-background"].value=_1e["bg"];_e["user-color-text"].value=_1e["text"];_e["user-color-links"].value=_1e["links"];_e["user-color-sidebar"].value=_1e["sidebar"];_e["user-color-sborder"].value=_1e["sborder"];$D.batch(_8,function(el){_1f.setInputColor(el);});_1f.setInputDefault();},setInputColor:function(_21){var _22=_21.value;var rgb=_7.hex2rgb(_22.substr(1));_21.style.backgroundColor=_22;if(rgb[0]>128&&rgb[1]>128&&rgb[2]>128){_21.style.color="#000000";}else{_21.style.color="#ffffff";}},setInputDefault:function(){if(!_f){return;}_d=_e["user-color-background"];_f.setValue(this.getInputColor(_d),true);},getInputColor:function(_24){var _25=_24.value.substr(1);return _7.hex2rgb(_25);},handleColorChange:function(o){var _27=this;var val=o.newValue;var _29="#"+_7.rgb2hex(val);_d.value=_29;_27.setInputColor(_d);switch(_d){case _e["user-color-background"]:this.setBg(null,null,null,null,_29,null);break;case _e["user-color-text"]:this.setBg(null,null,null,null,null,_29);break;case _e["user-color-links"]:this.setLinks(_29);break;case _e["user-color-sidebar"]:this.setSidebar(_29);break;case _e["user-color-sborder"]:this.setSidebar(null,_29);break;default:break;}},loadColorPicker:function(){if(_10){return;}_10=true;var _2a=this;_f=new YAHOO.widget.ColorPicker("colorpicker",{images:{PICKER_THUMB:"http://static.fanfou.com/img/picker_thumb.png",HUE_THUMB:"http://static.fanfou.com/img/hue_thumb.png"}});_f.on("rgbChange",function(o){_2a.handleColorChange.call(_2a,o);});_2a.setInputDefault();},switchTab:function(){var _2c=$D.get("tab-bg");var _2d=$D.get("tab-color");var _2e=$D.get("settings-background");var _2f=$D.get("settings-color");var _30=this;$E.on(_2c,"click",function(e){_5=true;if(_2e.style.display!="none"){_2e.style.display="none";$D.removeClass([_2c,_2d],"show");$D.removeClass([_2c,_2d],"current");return;}else{_2e.style.display="";_2f.style.display="none";$D.addClass([_2c,_2d],"show");$D.removeClass([_2c,_2d],"current");$D.addClass(this,"current");}});$E.on(_2d,"click",function(e){_5=true;if(_2f.style.display!="none"){_2f.style.display="none";$D.removeClass([_2c,_2d],"show");$D.removeClass([_2c,_2d],"current");return;}else{_2f.style.display="";_2e.style.display="none";$D.addClass([_2c,_2d],"show");$D.removeClass([_2c,_2d],"current");$D.addClass(this,"current");_30.loadColorPicker();}});},loadImage:function(src){var img=new Image();img.src=src;},init:function(_35){var _36=this;var _37=$D.get("settings-theme-list").getElementsByTagName("a");_7=YAHOO.util.Color;_6=_35;_8=$D.get("color-inputs").getElementsByTagName("input");_b=$D.get("user-background-repeat");_c=$D.get("user-background-center");_9=$D.get("user-current-background");_a=$D.get("user-no-background");_e=$D.get("form-setting-theme");$D.batch(_37,function(el){$E.on(el,"click",function(e){$E.preventDefault(e);var id=this.getAttribute("tid");$D.removeClass(_37,"current");$D.removeClass(_37,"hover");$D.addClass(this,"current");_36.render(id);_5=true;});$E.on(el,"mouseover",function(e){if(!$D.hasClass(this,"current")){$D.addClass(this,"hover");}});$E.on(el,"mouseout",function(e){if(!$D.hasClass(this,"current")){$D.removeClass(this,"hover");}});});$E.on(_b,"click",function(e){_36.setBg(null,null,this.checked?1:0,null,null,null);});$E.on(_c,"click",function(e){_36.setBg(null,null,null,this.checked?1:0,null,null);});$E.on(_9,"click",function(e){_36.setBg(null,this.getAttribute("rel"),null,null,null,null);_e.hidebg.value=0;});$E.on(_a,"click",function(e){_36.setBg(null,"",null,null,null,null);_e.hidebg.value=1;});$D.batch(_8,function(el){_36.setInputColor(el);$E.on(el,"click",function(el){_d=this;_f.setValue(_36.getInputColor(this),true);});});window.onbeforeunload=function(){if(_5){return "\u4f60\u8fd8\u6ca1\u6709\u4fdd\u5b58\u8bbe\u7f6e\u3002";}};$E.on(_e,"submit",function(e){_5=false;});_36.switchTab();$E.on("design-cancel","click",function(e){_5=false;window.location.reload();});if(_4==6){for(var i in _6){_36.loadImage(_6[i].bgpic);}}}};})();(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _4=YAHOO.util.KeyListener;var _5=YAHOO.env.ua.ie;var _6=(_5==6);var _7=YAHOO.env.ua.gecko;var _8=YAHOO.env.ua.webkit;var _9=YAHOO.env.ua.opera;var _a=YAHOO.lang.isString;var _b=FF.util.getText;var _c={create:"\u5173\u6ce8\u8fd9\u4e2a\u8bdd\u9898",destroy:"\u4e0d\u518d\u5173\u6ce8\u8fd9\u4e2a\u8bdd\u9898"};var _d=30;var _e=_d;var _f=300;var _10=20;var _11=1.6;var _12=null;var _13="HOME";var _14="USERVIEW";var _15="DIALOGUE";var _16="HOME_SEARCH";var _17="SEARCH";var _18="SEARCH_SELF";var _19=false;if(_19){_d=10;_e=10;_11=1;}function getSaveId(_1a,_1b){var lis=_1b.getElementsByTagName("li");for(var i=0,len=lis.length;i<len;i++){if(_b(lis[i])==_1a){return lis[i].getAttribute("sid");}}return 0;}function setSaveLink(_1f){var _20=$D.get("savedsearchs");var _21=$D.get("save-search-link");var _22=getSaveId(_1f,_20);_21.setAttribute("title",_1f);if(_22){_21.setAttribute("action","destroy");_21.setAttribute("sid",_22);_21.className="destroy-search-link";_21.innerHTML=_c.destroy;}else{_21.setAttribute("action","create");_21.setAttribute("sid",0);_21.className="create-search-link";_21.innerHTML=_c.create;}}function getCount(){var _23=$D.get("timeline-count");return _23.innerHTML?parseInt(_23.innerHTML,"10"):0;}function setCount(_24){var _25=$D.get("timeline-count");_25.innerHTML=_24;setTitle(_24);}function setTitle(_26){var reg=/\(\d+\)\s*/g;var _28=document.title;var _29="("+_26+") ";if(_26){if(reg.test(_28)){_28=_28.replace(reg,_29);}else{_28=_29+_28;}}else{_28=_28.replace(reg,"");}document.title=_28;}function setTimer(_2a){clearTimer();_e=(_e*_11<_f)?_e*_11:_f;_12=window.setInterval(_2a,_e*1000);}function clearTimer(){if(_12){window.clearInterval(_12);}}function resetInterval(){_e=_d;}function updateTime(){$D.getElementsByClassName("time","*","stream",function(el){var _2c=el.getAttribute("stime");var _2d=FF.util.parseDate(_2c).valueOf();_2d=_2d+FF.app.Timeline.srv_clk_minus_client;el.innerHTML=FF.util.getRelativeTime(_2d);});}function initStream(){FF.app.Stream.init();FF.app.Zoom.init("stream");}function getSinceId(){var _2e=$D.getElementsByClassName("time","*","stream");for(var i=0,len=_2e.length;i<len;i++){var id=_2e[i].getAttribute("ffid");if(id){return id;}}return null;}function handleMore(e){$E.stopEvent(e);this.blur();if($D.hasClass(this,"loading")){return;}var _33=$D.getAncestorByClassName(this,"pagination");var _34="\u66f4\u591a";var _35=this;var _36=$D.get("stream");var _37=_36.getElementsByTagName("ol")[0];$D.addClass(_37.lastChild,"last-more");var _38=$C.asyncRequest("GET",this.href,{success:function(o){var res=FF.util.getEvalRes(o);$D.removeClass(_35,"loading");_35.innerHTML=_34;if(res.status&&res.data){FF.app.Timeline.update_time_interval(res.srv_clk);if(res.data.count){_37.innerHTML+=res.data.timeline;updateTime();initStream();}if(res.data.next){_35.href=res.data.next;}else{_33.style.display="none";}}},failure:function(o){}});if($C.isCallInProgress(_38)){this.innerHTML="&nbsp;";$D.addClass(this,"loading");}}function handleRefresh(){var _3c=$D.get("stream");var _3d=_3c.getElementsByTagName("li");var _3e=$D.get("timeline-notification");var _3f=getCount();var _40=FF.app.Timeline;if(_3f&&_3f<_10){_3e.style.display="none";$D.removeClass(_3d,"last-refresh");for(var i=0;i<_3f;i++){var el=_3d[i];$D.removeClass(el,"buffered");if(i==_3f-1){$D.addClass(el,"last-refresh");}}setCount(0);updateTime();_40.processRefresh();}else{switch(_40.currentType){case _16:_40.processHomeSearch(_40.currentKeyword);break;case _13:case _14:case _15:case _17:default:window.location.reload();break;}}}FF.app.Timeline={timer:null,current:null,currentType:null,currentKeyword:null,currentAsync:null,currentSpinner:null,currentSinceId:null,srv_clk_minus_client:0,init:function(){$E.on(["trendtabs","savedsearchs"],"click",function(e){$E.stopEvent(e);var _44=$E.getTarget(e);var _45=_44.nodeName.toLowerCase();var _46;if(_45!="a"&&_45!="li"&&_45!="span"){return;}if(_45=="li"){_44=_44.getElementsByTagName("a")[0];}else{if(_45=="span"){_44=_44.parentNode;}}if(_44.getAttribute("squery")){_46=_44.getAttribute("squery");}else{_46=_b(_44);}if(!(/^\/home/).test(window.location.pathname)){window.location="/home#search?q="+encodeURIComponent(_46);return;}this.setCurrent(_44.parentNode);this.processHomeSearch(_46,_44);},this,true);this.initMoreAndRefresh();if(/^\/home/.test(window.location.pathname)){var _47=this.checkSearch();if(!_47){this.currentType=_13;this.processRefresh();}}},initMoreAndRefresh:function(){$E.on("pagination-more","click",handleMore);$E.on("timeline-notification","click",handleRefresh);},setCurrent:function(el){if(this.current){$D.removeClass(this.current,"current");}else{$D.removeClass($D.getElementsByClassName("current","li","navtabs"),"current");}this.current=el;$D.addClass(this.current,"current");},mark:function(_49){function find(el){return _b(el)==_49;}var lis=$D.getElementsBy(find,"li","savedsearchs");if(!lis.length){lis=$D.getElementsBy(find,"li","trendtabs");}if(lis.length){this.setCurrent(lis[0]);return lis[0];}else{this.setCurrent(null);return null;}},processRefresh:function(){var _4c=$D.get("stream");var _4d=_4c.getElementsByTagName("ol")[0];var _4e=$D.get("timeline-notification");var _4f=this;var _50=getSinceId();if(_50){_4f.currentSinceId=_50;resetInterval();setTimer(checkNew);}function checkNew(){var _51=encodeURIComponent(_4f.currentSinceId);var url="",_53="";switch(_4f.currentType){case _16:case _17:_53=encodeURIComponent(_4f.currentKeyword);url="/qc?q="+_53+"&since_id="+_51;break;case _14:case _15:url=_4f.currentAction+"?since_id="+_51;break;case _13:default:url="/hc?since_id="+_51;break;}$C.asyncRequest("GET",url,{success:function(o){var res=FF.util.getEvalRes(o);if(res.status){FF.app.Timeline.update_time_interval(res.srv_clk);if(res.data.count>0){var _56=getCount()+res.data.count;_4d.innerHTML=res.data.timeline+_4d.innerHTML;setCount(_56);_4e.style.display="block";initStream();_4f.currentSinceId=res.data.since_id;}}setTimer(checkNew);},failure:function(o){}});}},update_time_interval:function(_58){if(_a(_58)){var _59=FF.util.parseDate(_58).valueOf();var now=new Date();var _5b=parseInt((now.getTime()-_59),10);if(Math.abs(_5b)>60*1000){this.srv_clk_minus_client=_5b;}}},processHomeSearch:function(_5c,_5d){var _5e=this;var _5f=$D.get("searchr");var _60=$D.get("stream");var _61=$D.get("pagination-more");var _62=$D.get("timeline-head");var _63=$D.get("timeline-notification");var _64;this.currentType=_16;resetInterval();clearTimer();showSpinner(false);if(_5d){this.currentSpinner=$D.getNextSibling(_5d);$D.removeClass(_5f,"current");}else{this.currentSpinner=null;_64=true;}if(this.currentAsync){$C.abort(this.currentAsync);}this.currentAsync=$C.asyncRequest("GET","/q/"+encodeURIComponent(_5c),{success:handleResponse,failure:function(o){showSpinner(false);alert("\u6b64\u6b21\u641c\u7d22\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5");}});if($C.isCallInProgress(this.currentAsync)){showSpinner(true);}function handleResponse(o){_5e.currentKeyword=_5c;var res=FF.util.getEvalRes(o);if(res.status){FF.app.Timeline.update_time_interval(res.srv_clk);}else{_60.innerHTML="<h2>"+res.msg+"</h2>";_61.parentNode.style.display="none";}if(res.data.headline){_62.innerHTML=res.data.headline;_62.style.display="";}if(res.data.timeline){_60.innerHTML="<ol class=\"wa solo\">"+res.data.timeline+"</ol>";initStream();}if(res.data.next){_61.href=res.data.next;_61.parentNode.style.display="";}else{_61.parentNode.style.display="none";}setSaveLink(_5c);render(_5c);_64&&_5e.mark(_5c);showSpinner(false);_5e.saveSearch();removeTips();window.scrollTo(0,0);_5e.processRefresh();}function render(_68){var _69=_68.replace(/</g,"&lt;");window.location="/home#search?q="+encodeURIComponent(_68);document.title=_68+"_\u996d\u5426\u641c\u7d22";$D.get("search-keyword").innerHTML=_69;$D.get("searchr-input").value=_69;_63.style.display="none";$D.get("timeline-count").innerHTML="0";}function removeTips(){var _6a=$D.get("sysmsg-success");if(_6a){_6a.parentNode.removeChild(_6a);}$D.getElementsByClassName("sysmsg","div","container",function(el){el.style.display="none";});}function showSpinner(_6c){if(!_5e.currentSpinner){return;}_5e.currentSpinner.style.visibility=_6c?"visible":"hidden";}},checkSearch:function(){var _6d=window.location.hash;var _6e=window.location.href;if(!_6d){return false;}var _6f=_6e.match(/q=(.+)$/);_6f=_6f.length>1?_6f[1]:null;if(!_6f){return false;}_6f=decodeURIComponent(_6f);$D.removeClass($D.getElementsByClassName("current","li","navtabs"),"current");var li=this.mark(_6f);var _71=li?li.getElementsByTagName("a")[0]:null;this.processHomeSearch(_6f,_71);return true;},saveSearch:function(){var _72=$D.get("trendtabs");var _73=$D.get("savedsearchs");var _74=_73.getElementsByTagName("ul")[0];var _75=$D.get("save-search-link");var _76=this;if(_75.getAttribute("action")=="create"){_75.innerHTML=_c.create;}else{_75.innerHTML=_c.destroy;}_75.style.display="";$E.on(_75,"click",request);function request(e){$E.stopEvent(e);var _78={ajax:"yes"};var _79=this.getAttribute("title");var _7a=this.getAttribute("action");var id=this.getAttribute("sid");var _7c=_7a=="create";_78["q"]=_79;_78["id"]=id;_78["action"]="savedsearch."+_7a;_78["token"]=this.getAttribute("token");var _7d=$C.asyncRequest("POST","/home",{success:function(o){handleResponse(o,_79,_7c);},failure:function(o){}},FF.util.toPostData(_78));}function handleResponse(o,_81,_82){var res=FF.util.getEvalRes(o);var lis=_73.getElementsByTagName("li");if(res.status){FF.app.Timeline.update_time_interval(res.srv_clk);if(_82){if(_72){$D.removeClass(_72.getElementsByTagName("li"),"current");}var li=document.createElement("li");li.className="current";li.innerHTML="<a href=\"/q/"+_81+"\"><span class=\"label\">"+decodeURIComponent(_81)+"</span></a><div class=\"spinner\"></div>";li.setAttribute("sid",res.id);_74.appendChild(li);_74.style.display="";_73.style.display="";_76.setCurrent(li);}else{for(var i=0,len=lis.length;i<len;i++){if(_b(lis[i])==_81){_74.removeChild(lis[i]);break;}}if(!_73.getElementsByTagName("li").length){_73.style.display="none";}}setSaveLink(_81);}else{alert(res.msg);}}},initSearch:function(_88,_89){if(!_88||!_89){return;}this.currentKeyword=_88;this.initMoreAndRefresh();if(_89=="q"){this.currentType=_17;this.processRefresh();}else{if(_89=="ct"){this.currentType=_18;}}},initUserDialog:function(_8a){if(!_8a){return;}this.initMoreAndRefresh();this.currentAction=_8a;this.currentType=_15;this.processRefresh();},initUserView:function(_8b){if(!_8b){return;}this.initMoreAndRefresh();this.currentAction=_8b;this.currentType=_14;this.processRefresh();}};})();(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _4=YAHOO.util.KeyListener;var _5=YAHOO.env.ua.ie;var _6=(_5==6);var _7=YAHOO.env.ua.gecko;var _8=YAHOO.env.ua.webkit;var _9=YAHOO.env.ua.opera;var _a=YAHOO.lang.isString;FF.namespace("app.User","app.User.report");FF.app.User={report:function(){var el=$D.get("user-op-report");var _c=$D.get("overlay-report");var _d=$D.get("report-closeicon");var _e=$D.get("message-report");var _f=$D.get("report-succ");var _10=$D.get("report-succ");var _11=_e.parentNode;var _12=_e["content"];var _13=$D.getDocumentWidth();var _14=$D.getDocumentHeight();var _15=_12.value;var _16=$D.getElementsByClassName("formbutton","input",_e)[0];var _17=$D.getElementsByClassName("loading","img",_e)[0];var _18=false;var _19={};$E.on(el,"click",function(e){if(e){$E.stopEvent(e);}if($D.hasClass(el,"done")){return;}_f.style.display="none";_11.style.display="";_c.style.display="block";if(_5){_c.style.filter="";}else{$D.setStyle(_c,"opacity",1);}setCenter(_c);});$E.on(_d,"click",function(e){_c.style.display="none";});$E.on(document,"click",function(e){var _1d=$E.getTarget(e),_1e=_1d.nodeName.toLowerCase();if(_1d!=_c&&!$D.isAncestor(_c,_1d)){_c.style.display="none";}});$E.on(_12,"focus",function(e){if(this.value==_15){this.value="";$D.removeClass(this,"hint");}});$E.on(_12,"blur",function(e){if(this.value==""){this.value=_15;$D.addClass(this,"hint");}});$E.on(_e,"submit",doSubmit);FF.util.ctrlEnter(_12,doSubmit);function setCenter(_21){var _22=_21.offsetWidth;var _23=_21.offsetHeight;var _24=$D.getViewportWidth();var _25=$D.getViewportHeight();var top=$D.getDocumentScrollTop();x=(_24/2)-(_22/2);y=(_25/2)-(_23/2)+top;$D.setXY(_21,[x,y]);}function doSubmit(e){if(e){$E.stopEvent(e);}if(_18){return;}_18=true;_17.style.visibility="visible";_16.disabled=true;FF.ga.trackClick("/report");if(_12.value==_15){_12.value="";}$C.setForm(_e);$C.asyncRequest("POST","/home",{success:handleResponse,failure:function(o){}});function handleResponse(o){var res=FF.util.getEvalRes(o);if(res.status){_18=false;_17.style.visibility="hidden";_16.disabled=false;_f.innerHTML="<h2>\u8c22\u8c22\u4f60\u7684\u6295\u8bc9\uff0c\u996d\u5426\u5c06\u53d8\u5f97\u8d8a\u6765\u8d8a\u597d :)</h2>";_f.style.display="";_11.style.display="none";$D.addClass(el,"done");el.innerHTML="\u6295\u8bc9\u6210\u529f";window.setTimeout(function(){_c.style.display="none";_12.value=_15;$D.addClass(_12,"hint");},5000);}else{_18=false;_17.style.visibility="hidden";_16.disabled=false;alert(res.msg);}}}}};})();FF.app.Zoom=(function(){var $C=YAHOO.util.Connect;var $D=YAHOO.util.Dom;var $E=YAHOO.util.Event;var _4=YAHOO.util.KeyListener;var _5=YAHOO.env.ua.ie;var _6=(_5==6);var _7=YAHOO.env.ua.gecko;var _8=YAHOO.env.ua.webkit;var _9=YAHOO.env.ua.opera;var _a=YAHOO.lang.isString;var _b=true;var _c=5;var _d=15;var _e=1;var _f=90;var _10="0px 5px 25px rgba(0, 0, 0, ";var _11="http://static.fanfou.com/img/zoom/";var _12=0,_13=0,_14=0,_15=0,_16=0;var _17=false,_18=1,_19=false,_1a=0,_1b=new Image();var _1c=0;var _1d=[],_1e=[],_1f=[],_20=[],_21=[],_22=[];var _23=[],_24=[],_25=[],_26=[],_27=[];var _28,_29;var _2a="ZoomBox";var _2b="ZoomImage";var _2c="ZoomCaption";var _2d="ZoomCapDiv";function zoomPreload(_2e){var _2f=_2e.getAttribute("href");if(_1b.src.indexOf(_2e.getAttribute("href").substr(_2e.getAttribute("href").lastIndexOf("/")))==-1){_19=true;_1b=new Image();_1b.onload=function(){_19=false;};_1b.src=_2f;}}function preloadAnim(_30){if(_19!=false){document.getElementById("SpinImage").src=_11+"zoom-spin-"+_18+".png";_18++;if(_18>12){_18=1;}}else{document.getElementById("ZoomSpin").style.visibility="hidden";clearInterval(_1c);_1c=0;zoomIn(preloadFrom);}}function preloadAnimStart(){_1a=new Date();document.getElementById("imgbg").style.display="block";document.getElementById("ZoomSpin").style.left=(_12/2)+"px";document.getElementById("ZoomSpin").style.top=((_13/2)+_14)+"px";document.getElementById("ZoomSpin").style.visibility="visible";_18=1;document.getElementById("SpinImage").src=_11+"zoom-spin-"+_18+".png";_1c=setInterval(preloadAnim,100);}function zoomClick(_31,evt){var _33=getShift(evt);if(!evt&&window.event&&(window.event.metaKey||window.event.altKey)){return true;}else{if(evt&&(evt.metaKey||evt.altKey)){return true;}}if(_31.childNodes[0].width/_31.childNodes[0].height>3||_31.childNodes[0].height/_31.childNodes[0].width>3){window.location.href=_31.getAttribute("name");return true;}getSize();if(_19==true){if(_1c==0){preloadFrom=_31;preloadAnimStart();}}else{zoomIn(_31,_33);document.getElementById("imgbg").style.display="block";document.getElementById("ZoomToAlbum").innerHTML="<a href=\""+_31.getAttribute("name")+"\">\u53bb\u76f8\u518c\u67e5\u770b</a>";}return false;}function zoomIn(_34,_35){_29.src=_34.getAttribute("href");if(_34.childNodes[0].width){startW=_34.childNodes[0].width;startH=_34.childNodes[0].height;startPos=findElementPos(_34.childNodes[0]);}else{startW=50;startH=12;startPos=findElementPos(_34);}hostX=startPos[0];hostY=startPos[1];if(document.getElementById("scroller")){hostX=hostX-document.getElementById("scroller").scrollLeft;}endW=_1b.width;endH=_1b.height;if(_1d[_2b]!=true){if(document.getElementById("ShadowBox")){document.getElementById("ShadowBox").style.visibility="hidden";}else{if(!_5){if(_23[_2b]){clearInterval(_25[_2b]);_23[_2b]=false;_25[_2b]=false;}}}document.getElementById("ZoomClose").style.visibility="hidden";if(_b){document.getElementById(_2d).style.visibility="hidden";if(_34.getAttribute("title")&&_b){var _36=_34.getAttribute("title");if(_36.length>30){_36=_36.substr(0,30)+"...";}document.getElementById(_2c).innerHTML=_36;}else{document.getElementById(_2c).innerHTML="";}}_1f[_2b]=startW;_20[_2b]=startH;_21[_2b]=hostX;_22[_2b]=hostY;_29.style.width=startW+"px";_29.style.height=startH+"px";_28.style.left=hostX+"px";_28.style.top=hostY+"px";if(_e==1){setOpacity(0,_2a);}_28.style.visibility="visible";sizeRatio=endW/endH;if(endW>_12-_f){endW=_12-_f;endH=endW/sizeRatio;}if(endH>_13-_f){endH=_13-_f;endW=endH*sizeRatio;}zoomChangeX=((_12/2)-(endW/2)-hostX);zoomChangeY=(((_13/2)-(endH/2)-hostY)+_14);zoomChangeW=(endW-startW);zoomChangeH=(endH-startH);if(_35){tempSteps=_d*7;}else{tempSteps=_d;}zoomCurrent=0;if(_e==1){fadeCurrent=0;fadeAmount=(0-100)/tempSteps;}else{fadeAmount=0;}_1e[_2b]=setInterval(function(){zoomElement(_2a,_2b,zoomCurrent,startW,zoomChangeW,startH,zoomChangeH,hostX,zoomChangeX,hostY,zoomChangeY,tempSteps,_e,fadeAmount,function(){zoomDoneIn(_2a);});},_c);_1d[_2b]=true;}}function zoomOut(_37,evt){if(getShift(evt)){tempSteps=_d*7;}else{tempSteps=_d;}if(_1d[_2b]!=true){if(document.getElementById("ShadowBox")){document.getElementById("ShadowBox").style.visibility="hidden";}else{if(!_5){if(_23[_2b]){clearInterval(_25[_2b]);_23[_2b]=false;_25[_2b]=false;}}}document.getElementById("ZoomClose").style.visibility="hidden";document.getElementById("ZoomSpin").style.visibility="hidden";clearInterval(_1c);_1c=0;if(_b&&document.getElementById(_2c).innerHTML!=""){document.getElementById(_2d).style.visibility="hidden";}startX=parseInt(_28.style.left,10);startY=parseInt(_28.style.top,10);startW=_29.width;startH=_29.height;zoomChangeX=_21[_2b]-startX;zoomChangeY=_22[_2b]-startY;zoomChangeW=_1f[_2b]-startW;zoomChangeH=_20[_2b]-startH;zoomCurrent=0;if(_e==1){fadeCurrent=0;fadeAmount=(100-0)/tempSteps;}else{fadeAmount=0;}document.getElementById("imgbg").style.display="none";_1e[_2b]=setInterval(function(){zoomElement(_2a,_2b,zoomCurrent,startW,zoomChangeW,startH,zoomChangeH,startX,zoomChangeX,startY,zoomChangeY,tempSteps,_e,fadeAmount,function(){zoomDone(_2a,_2b);});},_c);_1d[_2b]=true;}}function zoomDoneIn(_39,_3a){_17=true;_39=document.getElementById(_39);if(document.getElementById("ShadowBox")){setOpacity(0,"ShadowBox");shadowdiv=document.getElementById("ShadowBox");shadowLeft=parseInt(_39.style.left,10)-13;shadowTop=parseInt(_39.style.top,10)-8;shadowWidth=_39.offsetWidth+26;shadowHeight=_39.offsetHeight+26;shadowdiv.style.width=shadowWidth+"px";shadowdiv.style.height=shadowHeight+"px";shadowdiv.style.left=shadowLeft+"px";shadowdiv.style.top=shadowTop+"px";document.getElementById("ShadowBox").style.visibility="visible";}else{if(!_5){fadeElementSetup("ZoomImage",0,0.8,5,0,"shadow");}}if(_b&&document.getElementById(_2c).innerHTML!=""){zoomcapd=document.getElementById(_2d);zoomcapd.style.top=parseInt(_39.style.top,10)+(_39.offsetHeight+15)+"px";zoomcapd.style.left=(_12/2)-(zoomcapd.offsetWidth/2)+"px";zoomcapd.style.visibility="visible";}if(!_5){setOpacity(0,"ZoomClose");}document.getElementById("ZoomClose").style.visibility="visible";if(!_5){fadeElementSetup("ZoomClose",0,100,5);}document.onkeypress=getKey;}function zoomDone(_3b,_3c){_17=false;_20[_3c]="";_1f[_3c]="";document.getElementById(_3b).style.visibility="hidden";_1d[_3c]==false;document.onkeypress=null;}function zoomElement(_3d,_3e,_3f,_40,_41,_42,_43,_44,_45,_46,_47,_48,_49,_4a,_4b){if(_3f==(_48+1)){_1d[_3e]=false;clearInterval(_1e[_3e]);_4b&&_4b();}else{if(_49==1){if(_4a<0){setOpacity(Math.abs(_3f*_4a),_3d);}else{setOpacity(100-(_3f*_4a),_3d);}}moveW=cubicInOut(_3f,_40,_41,_48);moveH=cubicInOut(_3f,_42,_43,_48);moveX=cubicInOut(_3f,_44,_45,_48);moveY=cubicInOut(_3f,_46,_47,_48);document.getElementById(_3d).style.left=moveX+"px";document.getElementById(_3d).style.top=moveY+"px";_29.style.width=moveW+"px";_29.style.height=moveH+"px";_3f++;clearInterval(_1e[_3e]);_1e[_3e]=setInterval(function(){zoomElement(_3d,_3e,_3f,_40,_41,_42,_43,_44,_45,_46,_47,_48,_49,_4a,_4b);},_c);}}function getKey(evt){if(!evt){theKey=event.keyCode;}else{theKey=evt.keyCode;}if(theKey==27){zoomOut(this,evt);}}function fadeOut(_4d){if(_4d.id){fadeElementSetup(_4d.id,100,0,10);}}function fadeIn(_4e){if(_4e.id){fadeElementSetup(_4e.id,0,100,10);}}function fadeElementSetup(_4f,_50,_51,_52,_53,_54){if(_23[_4f]==true){_24[_4f]=new Array(_4f,_50,_51,_52);}else{fadeSteps=_52;fadeCurrent=0;fadeAmount=(_50-_51)/fadeSteps;_25[_4f]=setInterval(function(){fadeElement(_4f,fadeCurrent,fadeAmount,fadeSteps);},15);_23[_4f]=true;_27[_4f]=_54;if(_53==1){_26[_4f]=true;}else{_26[_4f]=false;}}}function fadeElement(_55,_56,_57,_58){if(_56==_58){clearInterval(_25[_55]);_23[_55]=false;_25[_55]=false;if(_26[_55]==true){document.getElementById(_55).style.visibility="hidden";}if(_24[_55]&&_24[_55]!=false){fadeElementSetup(_24[_55][0],_24[_55][1],_24[_55][2],_24[_55][3]);_24[_55]=false;}}else{_56++;if(_27[_55]!="shadow"){if(_57<0){setOpacity(Math.abs(_56*_57),_55);}else{setOpacity(100-(_56*_57),_55);}}clearInterval(_25[_55]);_25[_55]=setInterval(function(){fadeElement(_55,_56,_57,_58);},15);}}function setOpacity(_59,_5a){$D.setStyle(_5a,"opacity",_59);if(_59==100&&_5){$D.get(_5a).style.filter="";}}function linear(t,b,c,d){return c*t/d+b;}function sineInOut(t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b;}function cubicIn(t,b,c,d){return c*(t/=d)*t*t+b;}function cubicOut(t,b,c,d){return c*((t=t/d-1)*t*t+1)+b;}function cubicInOut(t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b;}return c/2*((t-=2)*t*t+2)+b;}function bounceOut(t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b;}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b;}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b;}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b;}}}}function getSize(){if(self.innerHeight){_12=window.innerWidth;_13=window.innerHeight;_14=window.pageYOffset;}else{if(document.documentElement&&document.documentElement.clientHeight){_12=document.documentElement.clientWidth;_13=document.documentElement.clientHeight;_14=document.documentElement.scrollTop;}else{if(document.body){_12=document.body.clientWidth;_13=document.body.clientHeight;_14=document.body.scrollTop;}}}if(window.innerHeight&&window.scrollMaxY){_15=document.body.scrollWidth;_16=window.innerHeight+window.scrollMaxY;}else{if(document.body.scrollHeight>document.body.offsetHeight){_15=document.body.scrollWidth;_16=document.body.scrollHeight;}else{_15=document.body.offsetWidth;_16=document.body.offsetHeight;}}}function getShift(evt){var _74=false;if(!evt&&window.event){_74=window.event.shiftKey;}else{if(evt){_74=evt.shiftKey;if(_74){evt.stopPropagation();}}}return _74;}function findElementPos(_75){var _76=0;var _77=0;do{_76+=_75.offsetLeft;_77+=_75.offsetTop;}while(_75=_75.offsetParent);return Array(_76,_77);}function insertZoomHTML(){var _78=document.getElementsByTagName("body").item(0);var _79=document.createElement("div");_79.setAttribute("id","ZoomSpin");_79.style.position="absolute";_79.style.left="10px";_79.style.top="10px";_79.style.visibility="hidden";_79.style.zIndex="525";_78.insertBefore(_79,_78.firstChild);var _7a=document.createElement("img");_7a.setAttribute("id","SpinImage");_7a.setAttribute("src",_11+"zoom-spin-1.png");_79.appendChild(_7a);var _7b=document.createElement("div");_7b.setAttribute("id","ZoomBox");_7b.style.position="absolute";_7b.style.left="10px";_7b.style.top="10px";_7b.style.visibility="hidden";_7b.style.zIndex="499";_78.insertBefore(_7b,_79.nextSibling);var _7c=document.createElement("img");_7c.onclick=function(_7d){zoomOut(this,_7d);return false;};_7c.setAttribute("src",_11+"spacer.gif");_7c.setAttribute("id","ZoomImage");_7c.setAttribute("border","0");_7c.style.display="block";_7c.style.width="10px";_7c.style.height="10px";_7c.style.cursor="pointer";_7b.appendChild(_7c);var _7e=document.createElement("div");_7e.setAttribute("id","ZoomToAlbum");_7b.appendChild(_7e);var _7f=document.createElement("div");_7f.setAttribute("id","ZoomClose");_7f.style.position="absolute";_7f.style.right="-15px";_7f.style.top="-15px";_7f.style.visibility="hidden";_7b.appendChild(_7f);var _80=document.createElement("div");_80.className="close";_80.onclick=function(_81){zoomOut(this,_81);return false;};if(_b){var _82=document.createElement("div");var _83="<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr height=\"26\"><td class=\"left\"></td><td class=\"center\"><div id=\"ZoomCaption\"></div></td><td class=\"right\"></td></tr></table>";_82.setAttribute("id","ZoomCapDiv");_82.style.position="absolute";_82.style.visibility="hidden";_82.style.marginLeft="auto";_82.style.marginRight="auto";_82.style.zIndex="501";_82.innerHTML=_83;_78.insertBefore(_82,_7b.nextSibling);}var _84=document.createElement("div");_84.setAttribute("id","imgbg");_84.onclick=function(_85){zoomOut(this,_85);return false;};_78.insertBefore(_84,_82.nextSibling);}return {canZoom:function(el){var reg=/\.(jpg|jpeg|gif|png|bmp|tif|tiff)(\!\w+)?$/gi;if(el&&el.nodeName.toLowerCase()=="a"&&$D.hasClass(el,"zoom")){return el.getAttribute("href")&&el.getAttribute("href").search(reg)!=-1;}return false;},clean:function(el){el.onclick=null;el.onmouseover=null;},init:function(_89){if(_a(_89)){_89=$D.get(_89);}var _8a=this;$D.getElementsByClassName("zoom","a",_89,function(el){if(_8a.canZoom(el)){$E.on(el,"click",function(e){$E.stopEvent(e);return zoomClick(this,e);});$E.on(el,"mouseover",function(e){zoomPreload(this);});}});if(!!!document.getElementById("ZoomSpin")){insertZoomHTML();}_28=$D.get(_2a);_29=$D.get(_2b);}};})();